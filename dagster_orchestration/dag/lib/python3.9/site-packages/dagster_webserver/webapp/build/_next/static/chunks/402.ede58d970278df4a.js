"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[402],{38267:function(e,n,t){t.d(n,{Q1:function(){return y},Qf:function(){return R},zc:function(){return v}});var r=t(73235),s=t(52322),i=t(38491),o=t(39013),l=t(18149),u=t.n(l),c=t(2784),d=t(7267),a=t(35505),h=t(59351),m=t(52338),x=t(20958),p=t(20171),j=t(88610);function f(){let e=(0,r._)(["\n  query RunTabsCountQuery($queuedFilter: RunsFilter!, $inProgressFilter: RunsFilter!) {\n    queuedCount: pipelineRunsOrError(filter: $queuedFilter) {\n      ... on Runs {\n        count\n      }\n    }\n    inProgressCount: pipelineRunsOrError(filter: $inProgressFilter) {\n      ... on Runs {\n        count\n      }\n    }\n  }\n"]);return f=function(){return e},e}let g=e=>{switch(e){case"all":return"Runs | All runs";case"failed":return"Runs | Failed";case"in-progress":return"Runs | In progress";case"queued":return"Runs | Queued";case"scheduled":return"Runs | Scheduled";default:return"Runs"}},v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,x.aM)(k,{variables:{queuedFilter:{...e,statuses:Array.from(h.sy)},inProgressFilter:{...e,statuses:Array.from(h.Ys)}}}),{data:t}=n,{queuedCount:r,inProgressCount:o}=(0,c.useMemo)(()=>{var e,n;return{queuedCount:(null==t?void 0:null===(e=t.queuedCount)||void 0===e?void 0:e.__typename)==="Runs"?t.queuedCount.count:null,inProgressCount:(null==t?void 0:null===(n=t.inProgressCount)||void 0===n?void 0:n.__typename)==="Runs"?t.inProgressCount.count:null}},[t]),[l]=(0,m.oD)(),u=R(l);(0,p.j)(g(u));let d=e=>{let n=l.filter(e=>"status"!==e.token),t=e.map(e=>({token:"status",value:e}));return(0,m.it)([...t,...n])};return{tabs:(0,s.jsxs)(i.zH,{children:[(0,s.jsx)(y,{to:d([]),id:"all",$active:"all"===u,children:"All runs"}),(0,s.jsxs)(y,{to:d(Array.from(h.sy)),id:"queued",$active:"queued"===u,children:["Queued (",null!=r?r:"indeterminate",")"]}),(0,s.jsxs)(y,{to:d(Array.from(h.Ys)),id:"in-progress",$active:"in-progress"===u,children:["In progress (",null!=o?o:"indeterminate",")"]}),(0,s.jsx)(y,{to:d(Array.from(h.hd)),id:"failed",$active:"failed"===u,children:"Failed"}),(0,s.jsx)(y,{title:"Scheduled",to:"/runs/scheduled",id:"scheduled",$active:"scheduled"===u,children:"Scheduled"})]}),queryResult:n}},y=(0,a.ZP)(j.A).withConfig({componentId:"sc-56e7dbb1-0"})(["color:",";&&:hover{color:",";}",""],o.$(),o.$(),e=>{let{$active:n}=e;return n?(0,a.iv)(["background-color:",";color:",";&&:hover{background-color:",";color:",";}"],o.AU(),o.Ep(),o.AU(),o.Ep()):(0,a.iv)(["background-color:",";"],o.v8())}),R=e=>{let{pathname:n}=(0,d.TH)();if("/runs/timeline"===n)return"timeline";if("/runs/scheduled"===n)return"scheduled";if("/overview/backfills"===n)return"backfills";let t=new Set(e.filter(e=>"status"===e.token).map(e=>e.value));return u()(h.sy,t)?"queued":u()(h.Ys,t)?"in-progress":u()(h.hd,t)?"failed":"all"},k=(0,x.Ps)(f())},90402:function(e,n,t){t.r(n),t.d(n,{ScheduledRunListRoot:function(){return el},default:function(){return eu}});var r=t(73235),s=t(52322),i=t(49308),o=t(74580),l=t(35292),u=t(14934),c=t(16629),d=t(34147),a=t(89891),h=t(39013),m=t(38267),x=t(20958),p=t(8068),j=t(78491),f=t(16336),g=t(69737),v=t(20171),y=t(40782),R=t(74050),k=t(37483),C=t(38491),b=t(56619),w=t(1747),S=t(79106),q=t(55010),T=t(60603),_=t(20156),F=t(92506),N=t(19126),E=t.n(N),O=t(2784),P=t(47933),$=t(35505),z=t(86269),A=t(50309),U=t(23399),I=t(85227),J=t(88257),V=t(33847),K=t(10241),Q=t(43),Y=t(92199),H=t(20718),Z=t(10539);function L(){let e=(0,r._)(["\n  fragment ScheduleNextFiveTicksFragment on Schedule {\n    id\n    name\n    executionTimezone\n    mode\n    solidSelection\n    pipelineName\n    scheduleState {\n      id\n      status\n    }\n    futureTicks(limit: 5) {\n      results {\n        timestamp\n      }\n    }\n  }\n"]);return L=function(){return e},e}function B(){let e=(0,r._)(["\n  fragment RepositoryForNextTicksFragment on Repository {\n    name\n    id\n    location {\n      id\n      name\n    }\n    schedules {\n      id\n      ...ScheduleNextFiveTicksFragment\n    }\n  }\n\n  ","\n"]);return B=function(){return e},e}function M(){let e=(0,r._)(["\n  query ScheduleTickConfigQuery($scheduleSelector: ScheduleSelector!, $tickTimestamp: Int!) {\n    scheduleOrError(scheduleSelector: $scheduleSelector) {\n      ... on Schedule {\n        id\n        futureTick(tickTimestamp: $tickTimestamp) {\n          evaluationResult {\n            ...ScheduleFutureTickEvaluationResult\n          }\n        }\n      }\n    }\n  }\n\n  fragment ScheduleFutureTickEvaluationResult on TickEvaluation {\n    runRequests {\n      ...ScheduleFutureTickRunRequest\n    }\n    skipReason\n    error {\n      ...PythonErrorFragment\n    }\n  }\n\n  fragment ScheduleFutureTickRunRequest on RunRequest {\n    runKey\n    runConfigYaml\n    tags {\n      key\n      value\n    }\n  }\n\n  ","\n"]);return M=function(){return e},e}let D=(0,O.memo)(e=>{let{repos:n}=e,t=[],r=!1,i=!1,{options:o}=(0,Y.vl)();return(n.forEach(e=>{let{schedules:n}=e;i=i||n.length>0;let s={name:e.name,location:e.location.name},o=n.filter(e=>e.futureTicks.results.length&&e.scheduleState.status===J.ynu.RUNNING),l=Math.min(...o.map(e=>e.futureTicks.results[e.futureTicks.results.length-1].timestamp));o.forEach(e=>{e.futureTicks.results.forEach(n=>{n.timestamp<=l&&t.push({schedule:e,timestamp:n.timestamp,repoAddress:s})})}),r||(r=n.some(e=>!!e.mode))}),t.sort((e,n)=>e.timestamp-n.timestamp),t.length)?(0,s.jsxs)(w.i,{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{style:{width:"260px"},children:"Timestamp"}),(0,s.jsx)("th",{style:{width:"30%"},children:"Schedule"}),(0,s.jsx)("th",{children:r?"Job / Pipeline":"Job"}),(0,s.jsx)("th",{children:"Metadata"})]})}),(0,s.jsx)("tbody",{children:t.map(e=>{let{schedule:n,timestamp:t,repoAddress:r}=e,i=(0,Y.qz)(o,r);return(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)(z.v,{timestamp:t,timezone:n.executionTimezone,timeFormat:{showSeconds:!1,showTimezone:!0}})}),(0,s.jsx)("td",{children:(0,s.jsx)(P.rU,{to:(0,Z.$U)(r,"/schedules/".concat(n.name)),children:n.name})}),(0,s.jsx)("td",{children:(0,s.jsx)(V.h,{pipelineName:n.pipelineName,pipelineHrefContext:r,isJob:!!i&&(0,Y.E8)(i,n.pipelineName)})}),(0,s.jsx)("td",{children:(0,s.jsx)(G,{repoAddress:r,schedule:n,tickTimestamp:t})})]},"".concat(n.id,":").concat(t))})})]}):(0,s.jsx)(u.x,{padding:{vertical:32},children:(0,s.jsx)(k.t,{icon:"error",title:"No scheduled ticks",description:i?(0,s.jsxs)(s.Fragment,{children:["There are no running schedules."," ",(0,s.jsx)(P.rU,{to:"/overview/schedules",children:"Start a schedule"})," to see scheduled ticks."]}):(0,s.jsx)(s.Fragment,{children:"There are no schedules in this workspace. Create a running schedule to view its scheduled ticks."}),action:i?null:(0,s.jsx)(C.fr,{icon:(0,s.jsx)(b.JO,{name:"open_in_new"}),href:"https://docs.dagster.io/concepts/partitions-schedules-sensors/schedules",children:"View documentation"})})})}),G=(0,O.memo)(e=>{var n;let{repoAddress:t,schedule:r,tickTimestamp:i}=e,o={...(0,H.$)(t),scheduleName:r.name},[l,u]=(0,O.useState)(!1),[c,{called:d,loading:a,data:h}]=(0,x.td)(et,{variables:{scheduleSelector:o,tickTimestamp:i}}),m=!!d&&!a,p=(null==h?void 0:null===(n=h.scheduleOrError)||void 0===n?void 0:n.__typename)==="Schedule"?h.scheduleOrError.futureTick.evaluationResult:null,j=m?(0,s.jsx)(X,{repoAddress:t,schedule:r,loading:a,onItemOpen:u,evaluationResult:p}):(0,s.jsx)(S.$,{purpose:"body-text"});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(q.J,{content:(0,s.jsx)(T.v2,{children:j}),position:"bottom-right",onOpening:()=>{d||c()},children:(0,s.jsx)(C.zx,{icon:(0,s.jsx)(b.JO,{name:"expand_more"})})}),(0,s.jsx)(W,{repoAddress:t,isOpen:l,setOpen:u,schedule:r,tickTimestamp:i,evaluationResult:p})]})}),X=e=>{let{repoAddress:n,schedule:t,evaluationResult:r,loading:i,onItemOpen:o}=e;if(!r)return(0,s.jsx)(T.sN,{text:"Could not preview tick for this schedule"});if(r.skipReason)return(0,s.jsx)(T.sN,{text:"View skip reason...",onClick:()=>o(!0)});if(r.error)return(0,s.jsx)(T.sN,{text:"View error...",onClick:()=>o(!0)});if(!r.runRequests||!r.runRequests.length)return(0,s.jsx)(T.sN,{text:"No runs requested for this projected schedule tick"});if(1===r.runRequests.length){let e=r.runRequests[0],l=e?e.runConfigYaml:"";return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(T.sN,{text:i?"Loading Configuration...":"View Configuration...",icon:"open_in_new",onClick:()=>o(!0)}),(0,s.jsx)(Q.U,{text:"Open in Launchpad...",icon:"edit",target:"_blank",to:(0,Z.$U)(n,"/pipeline_or_job/".concat(t.pipelineName,"/playground/setup?").concat(E().stringify({mode:t.mode,config:l,solidSelection:t.solidSelection})))})]})}return(0,s.jsx)(T.sN,{text:"View ".concat(r.runRequests.length," run requests..."),icon:"edit",target:"_blank",onClick:()=>o(!0)})},W=e=>{let n,{repoAddress:t,evaluationResult:r,schedule:i,tickTimestamp:o,setOpen:c,isOpen:m}=e,[x,p]=(0,O.useState)(r&&r.runRequests&&1===r.runRequests.length?r.runRequests[0]:null),j=(0,I.m)(),f=(0,Y.Ux)(t),g=(0,Y.E8)(f,i.pipelineName);(0,O.useEffect)(()=>{r&&r.runRequests&&1===r.runRequests.length&&p(r.runRequests[0])},[r]);let v=()=>{p(null),c(!1)};return r?x?n=(0,s.jsxs)(u.x,{flex:{direction:"column",gap:20},children:[(0,s.jsxs)(u.x,{flex:{direction:"column",gap:12},padding:{top:16,horizontal:24},children:[(0,s.jsx)(l.pm,{children:"Tags"}),x.tags.length?(0,s.jsx)(K.Q,{tags:x.tags,mode:g?null:i.mode}):null]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.x,{border:"bottom",padding:{left:24,bottom:16},children:(0,s.jsx)(l.pm,{children:"Config"})}),(0,s.jsx)(_.u,{value:x.runConfigYaml,options:{readOnly:!0,lineNumbers:!0,mode:"yaml"}})]})]}):r.error?n=(0,s.jsx)(F.a7,{children:(0,s.jsx)(U.T9,{error:r.error})}):r.skipReason?n=(0,s.jsx)(F.a7,{children:(0,s.jsx)(es,{children:r.skipReason})}):r.runRequests&&(n=(0,s.jsx)(F.a7,{children:(0,s.jsx)(er,{children:(0,s.jsxs)(w.i,{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Run key"}),(0,s.jsx)("th",{children:"Config"}),(0,s.jsx)("th",{children:"Actions"})]})}),(0,s.jsx)("tbody",{children:r.runRequests.map((e,n)=>e?(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:e.runKey||(0,s.jsx)("span",{children:"â€”"})}),(0,s.jsx)("td",{children:(0,s.jsx)(a.Z,{onClick:()=>p(e),underline:!1,children:(0,s.jsxs)(d.Z,{direction:"row",spacing:8,alignItems:"center",children:[(0,s.jsx)(b.JO,{name:"open_in_new",color:h.$()}),(0,s.jsx)("span",{children:"View config"})]})})}),(0,s.jsx)("td",{children:(0,s.jsx)(q.J,{content:(0,s.jsx)(T.v2,{children:(0,s.jsx)(Q.U,{text:"Open in Launchpad...",icon:"edit",target:"_blank",to:(0,Z.$U)(t,"/".concat(g?"jobs":"pipelines","/").concat(i.pipelineName,"/playground/setup?").concat(E().stringify({mode:i.mode,config:e.runConfigYaml,solidSelection:i.solidSelection})))})}),position:"bottom",children:(0,s.jsx)(C.zx,{icon:(0,s.jsx)(b.JO,{name:"expand_more"})})})})]},n):null)})]})})})):n=null,(0,s.jsxs)(F.Vq,{onClose:()=>v(),style:{width:"50vw"},title:(0,s.jsxs)(u.x,{flex:{direction:"row",gap:4},children:[(0,s.jsx)(z.v,{timestamp:o,timezone:i.executionTimezone}),(null==x?void 0:x.runKey)?(0,s.jsxs)("div",{children:[": ",null==x?void 0:x.runKey]}):null]}),isOpen:m,children:[n,(0,s.jsxs)(F.cN,{topBorder:!0,children:[x?(0,s.jsx)(C.zx,{autoFocus:!1,onClick:async()=>{j(x.runConfigYaml),await (0,A.B7)({intent:"success",icon:"copy_to_clipboard_done",message:"Copied!"})},children:"Copy config"}):null,(0,s.jsx)(C.zx,{intent:"primary",autoFocus:!0,onClick:()=>v(),children:"OK"})]})]})},ee=(0,x.Ps)(L()),en=(0,x.Ps)(B(),ee),et=(0,x.Ps)(M(),j.B),er=$.ZP.div.withConfig({componentId:"sc-ea62ebec-0"})(["font-size:13px;"]),es=$.ZP.div.withConfig({componentId:"sc-ea62ebec-1"})(["background-color:",";border:1px solid ",";border-radius:3px;"],h.B5(),h.qr());var ei=t(59923);function eo(){let e=(0,r._)(["\n  query ScheduledRunsListQuery {\n    instance {\n      id\n      ...InstanceHealthFragment\n    }\n    repositoriesOrError {\n      ... on RepositoryConnection {\n        nodes {\n          id\n          ... on Repository {\n            id\n            ...RepositoryForNextTicksFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n  ","\n"]);return eo=function(){return e},e}let el=()=>{(0,g.Px)(),(0,v.j)("Runs | Scheduled");let e=(0,x.aM)(ec,{notifyOnNetworkStatusChange:!0}),n=(0,f.C4)(e,f.dT),{tabs:t,queryResult:r}=(0,m.zc)(),j=(0,f.C4)(r,f.dT),y=(0,f.V5)(j,n);return(0,s.jsxs)(i.T,{children:[(0,s.jsx)(o.m,{title:(0,s.jsx)(l.X6,{children:"Runs"}),right:(0,s.jsx)(f.xi,{refreshState:y})}),(0,s.jsx)(u.x,{flex:{direction:"row",gap:8,alignItems:"center",justifyContent:"space-between"},padding:{vertical:12,left:24,right:12},children:t}),(0,s.jsx)(ei.g,{queryResult:e,allowStaleData:!0,children:e=>{let{repositoriesOrError:n,instance:t}=e;if("RepositoryConnection"!==n.__typename){let e="PythonError"===n.__typename?n.message:"Repository not found";return(0,s.jsx)(c.b,{intent:"warning",title:(0,s.jsxs)(d.Z,{direction:"row",spacing:4,children:[(0,s.jsx)("div",{children:"Could not load scheduled ticks."}),(0,s.jsx)(a.Z,{color:h.Es(),underline:"always",onClick:()=>{(0,p._K)({title:"Python error",body:e})},children:"View error"})]})})}return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(R.K,{daemonHealth:t.daemonHealth,padding:{vertical:16,horizontal:24}}),(0,s.jsx)(D,{repos:n.nodes})]})}})]})};var eu=el;let ec=(0,x.Ps)(eo(),y.O,en,j.B)},74050:function(e,n,t){t.d(n,{K:function(){return o}});var r=t(52322),s=t(14934),i=t(16629);t(2784);let o=e=>{let n,{daemonHealth:t,...o}=e;if(t){let e=t.allDaemonStatuses.filter(e=>"SCHEDULER"===e.daemonType);if(e.length>0){let t=e[0];n=t.required&&t.healthy}}return!1===n?(0,r.jsx)(s.x,{...o,children:(0,r.jsx)(i.b,{intent:"warning",title:"The scheduler daemon is not running.",description:(0,r.jsxs)("div",{children:["See the"," ",(0,r.jsx)("a",{href:"https://docs.dagster.io/deployment/dagster-daemon",children:"dagster-daemon documentation"})," ","for more information on how to deploy the dagster-daemon process."]})})}):null}}}]);
//# sourceMappingURL=402.ede58d970278df4a.js.map