"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3065],{43250:function(e,n,t){t.d(n,{C:function(){return u}});var r=t(52322),o=t(92506),s=t(14934),l=t(38491),i=t(56619),a=t(2784),c=t(44231),d=t(8355);let u=()=>{let{allRepos:e,visibleRepos:n,toggleVisible:t}=(0,a.useContext)(d.C5),[u,h]=(0,a.useState)(!1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(o.Vq,{canOutsideClickClose:!0,canEscapeKeyClose:!0,isOpen:u,style:{width:"auto"},onClose:()=>h(!1),children:[(0,r.jsx)(o.fK,{icon:"repo",label:"Filter code locations"}),(0,r.jsx)(c.e,{options:e,onBrowse:()=>h(!1),onToggle:t,selected:n}),(0,r.jsx)(o.cN,{children:(0,r.jsx)(s.x,{padding:{top:8},children:(0,r.jsx)(l.zx,{intent:"none",onClick:()=>h(!1),children:"Done"})})})]}),(0,r.jsx)(l.zx,{outlined:!0,icon:(0,r.jsx)(i.JO,{name:"folder"}),rightIcon:(0,r.jsx)(i.JO,{name:"expand_more"}),onClick:()=>h(!0),children:"".concat(n.length," of ").concat(e.length)})]})}},63065:function(e,n,t){t.d(n,{e:function(){return I}});var r=t(73235),o=t(52322),s=t(14934),l=t(79106),i=t(39013),a=t(37483),c=t(74159),d=t(45774),u=t(2784),h=t(20958),p=t(78491),j=t(16336),x=t(44900),f=t(4378),g=t(43250),m=t(35002),y=t(43212),b=t(88510),w=t(22921),C=t(17008),v=t(98956),E=t(50646),k=t(63485),L=t(83738),S=t(22563);let z=e=>{let{repos:n}=e,t=(0,u.useRef)(null),r=(0,u.useMemo)(()=>n.map(e=>{let{repoAddress:n}=e;return(0,S.Uz)(n)}),[n]),{expandedKeys:s,onToggle:l,onToggleAll:i}=(0,E.N)(w.y,r),a=(0,u.useMemo)(()=>{let e=[];return n.forEach(n=>{let{repoAddress:t,jobs:r}=n;e.push({type:"header",repoAddress:t,jobCount:r.length});let o=(0,S.Uz)(t);s.includes(o)&&r.forEach(n=>{let{isJob:r,name:o}=n;e.push({type:"job",repoAddress:t,isJob:r,name:o})})}),e},[n,s]),c=(0,v.w)(n.map(e=>{let{repoAddress:n}=e;return n.name})),d=(0,b.MG)({count:a.length,getScrollElement:()=>t.current,estimateSize:e=>{let n=a[e];return(null==n?void 0:n.type)==="header"?C.lo:64},overscan:10}),h=d.getTotalSize(),p=d.getVirtualItems();return(0,o.jsx)("div",{style:{overflow:"hidden"},children:(0,o.jsxs)(C.W2,{ref:t,children:[(0,o.jsx)(k.I,{}),(0,o.jsx)(C.Nh,{$totalHeight:h,children:p.map(e=>{let{index:n,key:t,size:r,start:d}=e,u=a[n];return"header"===u.type?(0,o.jsx)(L.vG,{repoAddress:u.repoAddress,height:r,start:d,onToggle:l,onToggleAll:i,expanded:s.includes((0,S.Uz)(u.repoAddress)),showLocation:c.has(u.repoAddress.name),rightElement:(0,o.jsx)(m.u,{content:1===u.jobCount?"1 job":"".concat(u.jobCount," jobs"),placement:"top",children:(0,o.jsx)(y.V,{children:u.jobCount})})},t):(0,o.jsx)(k.b,{name:u.name,isJob:u.isJob,repoAddress:u.repoAddress,height:r,start:d},t)})})]})})};var A=t(907),N=t(49455),O=t(34219),_=t(73658),J=t(8355),U=t(65822);function M(){let e=(0,r._)(["\n  query OverviewJobsQuery {\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                pipelines {\n                  id\n                  name\n                  isJob\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n"]);return M=function(){return e},e}let I=()=>{let{allRepos:e,visibleRepos:n,loading:t,data:r}=(0,u.useContext)(J.C5),[p,x]=(0,f.q)({queryKey:"search",defaults:{search:""}}),m=e.length,y=(0,h.aM)(T,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),{data:b,loading:w}=y,C=(0,j.C4)(y,j.dT),v=(0,u.useMemo)(()=>{let e=Object.values(r).filter(e=>"WorkspaceLocationEntry"===e.__typename),t=null==b?void 0:b.workspaceOrError,o=(null==t?void 0:t.__typename)==="Workspace"?t.locationEntries:e,s=(0,N.S)(n);return F(o).filter(e=>{let{repoAddress:n}=e;return s.has((0,S.Uz)(n))})},[r,b,n]),E=!b&&t;(0,O.j$)("OverviewJobs",!E);let k=p.trim().toLocaleLowerCase(),L=k.length>0,A=(0,u.useMemo)(()=>{let e=k.toLocaleLowerCase();return v.map(n=>{let{repoAddress:t,jobs:r}=n;return{repoAddress:t,jobs:r.filter(n=>{let{name:t}=n;return t.toLocaleLowerCase().includes(e)})}}).filter(e=>{let{jobs:n}=e;return n.length>0})},[v,k]),U=w&&!b;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(s.x,{padding:{horizontal:24,vertical:12},flex:{direction:"row",alignItems:"center",justifyContent:"space-between",grow:0},children:[(0,o.jsxs)(s.x,{flex:{direction:"row",gap:12,alignItems:"center"},children:[m>1?(0,o.jsx)(g.C,{}):null,(0,o.jsx)(c.oi,{icon:"search",value:p,rightElement:U?(0,o.jsx)(_.W,{tooltipContent:"Loading jobs…"}):void 0,onChange:e=>x(e.target.value),placeholder:"Filter by job name…",style:{width:"340px"}})]}),(0,o.jsx)(j.xi,{refreshState:C})]}),E&&!m?(0,o.jsx)(s.x,{padding:64,children:(0,o.jsx)(d.f,{label:"Loading jobs…"})}):(()=>{if(E)return(0,o.jsx)(s.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,o.jsxs)(s.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,o.jsx)(l.$,{purpose:"body-text"}),(0,o.jsx)("div",{style:{color:i.$()},children:"Loading jobs…"})]})});let t=e.length>n.length;return A.length?(0,o.jsx)(z,{repos:A}):L?(0,o.jsx)(s.x,{padding:{top:20},children:(0,o.jsx)(a.t,{icon:"search",title:"No matching jobs",description:t?(0,o.jsxs)("div",{children:["No jobs matching ",(0,o.jsx)("strong",{children:p})," were found in the selected code locations"]}):(0,o.jsxs)("div",{children:["No jobs matching ",(0,o.jsx)("strong",{children:p})," were found in your definitions"]})})}):(0,o.jsx)(s.x,{padding:{top:20},children:(0,o.jsx)(a.t,{icon:"search",title:"No jobs",description:t?"No jobs were found in the selected code locations":"No jobs were found in your definitions"})})})()]})},F=e=>{let n=e.map(e=>e.locationOrLoadError),t=[];for(let e of n)if((null==e?void 0:e.__typename)==="RepositoryLocation")for(let n of e.repositories){let{name:r,pipelines:o}=n,s=(0,U.kQ)(r,e.name),l=o.filter(e=>{let{name:n}=e;return!(0,x.pv)(n)}).map(e=>({isJob:e.isJob,name:e.name}));l.length>0&&t.push({repoAddress:s,jobs:l})}return(0,A.S)(t)},T=(0,h.Ps)(M(),p.B)},22921:function(e,n,t){t.d(n,{y:function(){return r}});let r="overview-collapsed-state"},907:function(e,n,t){t.d(n,{S:function(){return o}});var r=t(22563);let o=e=>[...e].sort((e,n)=>{let t=(0,r.Uz)(e.repoAddress),o=(0,r.Uz)(n.repoAddress);return t.localeCompare(o)})},49455:function(e,n,t){t.d(n,{S:function(){return s}});var r=t(65822),o=t(22563);let s=e=>new Set(e.map(e=>(0,o.Uz)((0,r.kQ)(e.repository.name,e.repositoryLocation.name))))},98956:function(e,n,t){t.d(n,{w:function(){return r}});let r=e=>{let n=new Set,t=new Set;return e.forEach(e=>{n.has(e)?t.add(e):n.add(e)}),t}},50646:function(e,n,t){t.d(n,{N:function(){return c}});var r=t(2784),o=t(4128),s=t(30001),l=t(22563);let i=e=>Array.isArray(e)?e:[],a=(e,n)=>"".concat(e,":dagster.").concat(n),c=(e,n)=>{let{basePath:t}=(0,r.useContext)(o.I),c=a(t,e),[d,u]=(0,s.U)(c,i),h=(0,r.useCallback)(e=>{let n="object"==typeof e?(0,l.Uz)(e):e;u(e=>{let t=new Set(e||[]);return t.has(n)?t.delete(n):t.add(n),Array.from(t)})},[u]),p=(0,r.useCallback)(e=>{u(t=>{let r=new Set(t||[]);return n.forEach(n=>{e?r.delete(n):r.add(n)}),Array.from(r)})},[n,u]),j=(0,r.useMemo)(()=>{let e=new Set(d);return n.filter(n=>!e.has(n))},[n,d]);return(0,r.useMemo)(()=>({expandedKeys:j,onToggle:h,onToggleAll:p}),[j,h,p])}}}]);
//# sourceMappingURL=3065.4ee9d5af6b1f1010.js.map