(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6268],{96795:function(e,n,r){var t=r(36740)(function(e,n,r){e[r?0:1].push(n)},function(){return[[],[]]});e.exports=t},35232:function(e,n,r){"use strict";r.d(n,{_:function(){return l}});var t=r(73235),u=r(20958);function i(){let e=(0,t._)(["\n  query InstanceConfigHasInfo {\n    instance {\n      id\n      hasInfo\n    }\n  }\n"]);return i=function(){return e},e}let l=()=>{var e;return!!(null===(e=(0,u.aM)(s).data)||void 0===e?void 0:e.instance.hasInfo)},s=(0,u.Ps)(i())},38267:function(e,n,r){"use strict";r.d(n,{Q1:function(){return R},Qf:function(){return j},zc:function(){return y}});var t=r(73235),u=r(52322),i=r(38491),l=r(39013),s=r(18149),o=r.n(s),a=r(2784),d=r(7267),c=r(35505),f=r(59351),h=r(52338),p=r(20958),v=r(20171),m=r(88610);function x(){let e=(0,t._)(["\n  query RunTabsCountQuery($queuedFilter: RunsFilter!, $inProgressFilter: RunsFilter!) {\n    queuedCount: pipelineRunsOrError(filter: $queuedFilter) {\n      ... on Runs {\n        count\n      }\n    }\n    inProgressCount: pipelineRunsOrError(filter: $inProgressFilter) {\n      ... on Runs {\n        count\n      }\n    }\n  }\n"]);return x=function(){return e},e}let g=e=>{switch(e){case"all":return"Runs | All runs";case"failed":return"Runs | Failed";case"in-progress":return"Runs | In progress";case"queued":return"Runs | Queued";case"scheduled":return"Runs | Scheduled";default:return"Runs"}},y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,p.aM)(C,{variables:{queuedFilter:{...e,statuses:Array.from(f.sy)},inProgressFilter:{...e,statuses:Array.from(f.Ys)}}}),{data:r}=n,{queuedCount:t,inProgressCount:l}=(0,a.useMemo)(()=>{var e,n;return{queuedCount:(null==r?void 0:null===(e=r.queuedCount)||void 0===e?void 0:e.__typename)==="Runs"?r.queuedCount.count:null,inProgressCount:(null==r?void 0:null===(n=r.inProgressCount)||void 0===n?void 0:n.__typename)==="Runs"?r.inProgressCount.count:null}},[r]),[s]=(0,h.oD)(),o=j(s);(0,v.j)(g(o));let d=e=>{let n=s.filter(e=>"status"!==e.token),r=e.map(e=>({token:"status",value:e}));return(0,h.it)([...r,...n])};return{tabs:(0,u.jsxs)(i.zH,{children:[(0,u.jsx)(R,{to:d([]),id:"all",$active:"all"===o,children:"All runs"}),(0,u.jsxs)(R,{to:d(Array.from(f.sy)),id:"queued",$active:"queued"===o,children:["Queued (",null!=t?t:"indeterminate",")"]}),(0,u.jsxs)(R,{to:d(Array.from(f.Ys)),id:"in-progress",$active:"in-progress"===o,children:["In progress (",null!=l?l:"indeterminate",")"]}),(0,u.jsx)(R,{to:d(Array.from(f.hd)),id:"failed",$active:"failed"===o,children:"Failed"}),(0,u.jsx)(R,{title:"Scheduled",to:"/runs/scheduled",id:"scheduled",$active:"scheduled"===o,children:"Scheduled"})]}),queryResult:n}},R=(0,c.ZP)(m.A).withConfig({componentId:"sc-56e7dbb1-0"})(["color:",";&&:hover{color:",";}",""],l.$(),l.$(),e=>{let{$active:n}=e;return n?(0,c.iv)(["background-color:",";color:",";&&:hover{background-color:",";color:",";}"],l.AU(),l.Ep(),l.AU(),l.Ep()):(0,c.iv)(["background-color:",";"],l.v8())}),j=e=>{let{pathname:n}=(0,d.TH)();if("/runs/timeline"===n)return"timeline";if("/runs/scheduled"===n)return"scheduled";if("/overview/backfills"===n)return"backfills";let r=new Set(e.filter(e=>"status"===e.token).map(e=>e.value));return o()(f.sy,r)?"queued":o()(f.Ys,r)?"in-progress":o()(f.hd,r)?"failed":"all"},C=(0,p.Ps)(x())},6268:function(e,n,r){"use strict";r.r(n),r.d(n,{RunsRoot:function(){return M},default:function(){return V}});var t=r(52322),u=r(49853),i=r(14934),l=r(49308),s=r(74580),o=r(35292),a=r(37483),d=r(89891),c=r(80122),f=r(96795),h=r.n(f),p=r(2784),v=r(73235),m=r(16629),x=r(47933),g=r(20958),y=r(9108),R=r(35232);function j(){let e=(0,v._)(['\n  query QueueDaemonStatusQuery {\n    instance {\n      id\n      daemonHealth {\n        id\n        daemonStatus(daemonType: "QUEUED_RUN_COORDINATOR") {\n          id\n          daemonType\n          healthy\n          required\n        }\n      }\n    }\n  }\n']);return j=function(){return e},e}let C=()=>{let e=(0,R._)();return(0,t.jsxs)(i.x,{flex:{direction:"column",gap:8},style:{minWidth:"100%"},border:"bottom",children:[e&&(0,t.jsx)(m.b,{intent:"info",title:(0,t.jsx)(x.rU,{to:"/config#run_coordinator",children:"View queue configuration"})}),e&&(0,t.jsx)(b,{})]})},b=()=>{let{data:e}=(0,g.aM)(q),{pageTitle:n}=(0,p.useContext)(y.N),r=null==e?void 0:e.instance.daemonHealth.daemonStatus;return(null==r?void 0:r.required)&&!(null==r?void 0:r.healthy)?(0,t.jsx)(m.b,{intent:"warning",title:"The queued run coordinator is not healthy.",description:(0,t.jsxs)("div",{children:["View ",(0,t.jsx)(x.rU,{to:"/health",children:n})," for details."]})}):null},q=(0,g.Ps)(j());var E=r(38267),_=r(59351),k=r(33298),w=r(33182),P=r(52338),A=r(38491),F=r(18149),$=r.n(F),T=r(96569);function I(){let e=(0,v._)(["\n  query TerminateRunIdsQuery($filter: RunsFilter!) {\n    pipelineRunsOrError(filter: $filter) {\n      ... on Runs {\n        results {\n          id\n          status\n          canTerminate\n        }\n      }\n    }\n  }\n"]);return I=function(){return e},e}let O=e=>{let{refetch:n,filter:r,disabled:u}=e,[i,l]=(0,p.useState)(null),s=(0,g.xJ)(),o=async()=>{let e=await s.query({query:Q,variables:{filter:r}});l("Runs"===e.data.pipelineRunsOrError.__typename?Object.fromEntries(e.data.pipelineRunsOrError.results.map(e=>[e.id,e.canTerminate])):{})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T.A,{isOpen:null!==i,selectedRuns:i||{},selectedRunsAllQueued:$()(r,{statuses:Array.from(_.sy)}),onClose:()=>l(null),onComplete:()=>n()}),(0,t.jsx)(A.zx,{intent:"danger",outlined:!0,disabled:u,onClick:o,children:"Terminate allâ€¦"})]})},Q=(0,g.Ps)(I());var S=r(74928),H=r(16336),N=r(69737),U=r(28316);function Y(e){let{node:n}=e,r=p.useRef(null);return p.useLayoutEffect(()=>{let e=r.current;if(n.parentNode!==e){if(null!==n.parentNode&&n.parentNode!==e)throw Error("Cannot render the same node twice");return null==e||e.appendChild(n),()=>{null==e||e.removeChild(n)}}},[n]),(0,t.jsx)("div",{ref:r})}var z=r(59923),D=r(85062);let M=()=>{(0,N.Px)();let[e,n]=(0,P.oD)(),r=(0,P.VH)(e),{queryResult:f,paginationProps:v}=(0,S.E)(r,25),m=(0,H.C4)(f,H.dT),x=(0,E.Qf)(e),g="all"!==x,[y,R]=h()(e,e=>"status"===e.token),j=(0,p.useCallback)(e=>{g?n([...y,...e]):n(e)},[n,g,y]),b=(0,p.useCallback)(e=>{let n=(0,u.HY)(e);R.some(e=>(0,u.HY)(e)===n)||j([...R,e])},[R,j]),q=(0,p.useMemo)(()=>{let e=["tag","snapshotId","id","job","pipeline","partition","backfill"];return g||e.push("status"),e},[g]),A=(0,p.useMemo)(()=>g?e.filter(e=>"status"!==e.token):e,[e,g]),{tabs:F,queryResult:$}=(0,E.zc)(r),T=(0,H.C4)($,H.dT),I=(0,H.V5)(T,m),{button:Q,activeFiltersJsx:M}=(0,P.Vv)({tokens:A,onChange:j,enabledFilters:q}),[V,L]=function(e){let[n,r]=p.useState(null);return p.useLayoutEffect(()=>{r(e=>null===e?document.createElement("div"):e)},[]),[n?(0,U.createPortal)(e,n):null,n?(0,t.jsx)(Y,{node:n}):null]}(Q);function Z(){var e,n,u,l;return(0,t.jsxs)(i.x,{style:{width:"100%",marginRight:8},flex:{justifyContent:"space-between"},children:[(0,t.jsxs)(i.x,{flex:{direction:"row",alignItems:"center",gap:8},children:[F,L]}),"queued"===x?(0,t.jsx)(O,{refetch:I.refetch,filter:{...r,statuses:Array.from(_.sy)},disabled:(null===(e=$.data)||void 0===e?void 0:e.queuedCount.__typename)!=="Runs"||(null===(n=$.data)||void 0===n?void 0:n.queuedCount.count)===0}):"in-progress"===x?(0,t.jsx)(O,{refetch:I.refetch,filter:{...r,statuses:Array.from(_.Ys)},disabled:(null===(u=$.data)||void 0===u?void 0:u.inProgressCount.__typename)!=="Runs"||(null===(l=$.data)||void 0===l?void 0:l.inProgressCount.count)===0}):void 0]})}return(0,t.jsxs)(l.T,{children:[(0,t.jsx)(s.m,{title:(0,t.jsx)(o.X6,{children:"Runs"}),right:(0,t.jsx)(H.xi,{refreshState:I})}),V,(0,t.jsx)(w.Lw.Provider,{value:{refetch:f.refetch},children:(0,t.jsx)(z.g,{queryResult:f,allowStaleData:!0,renderError:e=>{let n=!!((null==e?void 0:e.networkError)&&"statusCode"in e.networkError&&400===e.networkError.statusCode);return(0,t.jsxs)(i.x,{flex:{direction:"column",gap:32},padding:{vertical:8,horizontal:24},children:[Z(),(0,t.jsx)(a.t,{icon:"warning",title:n?"Invalid run filters":"Unexpected error",description:n?"The specified run filters are not valid. Please check the filters and try again.":"An unexpected error occurred. Check the console for details."})]})},children:e=>{let{pipelineRunsOrError:n}=e;return"Runs"!==n.__typename?(0,t.jsx)(i.x,{padding:{vertical:64},children:(0,t.jsx)(a.t,{icon:"error",title:"Query Error",description:n.message})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(D.Y,{$top:0,children:(0,t.jsx)(k.A,{runs:n.results,onAddTag:b,filter:r,actionBarComponents:Z(),belowActionBarComponents:"queued"===x||M.length?(0,t.jsxs)(t.Fragment,{children:["queued"===x&&(0,t.jsx)(C,{}),M.length>0&&(0,t.jsxs)(t.Fragment,{children:[M,(0,t.jsx)(d.Z,{onClick:()=>j([]),children:"Clear all"})]})]}):null})}),n.results.length>0?(0,t.jsx)("div",{style:{marginTop:"16px"},children:(0,t.jsx)(c.pI,{...v})}):null]})}})})]})};var V=M},74928:function(e,n,r){"use strict";r.d(n,{E:function(){return a},z:function(){return d}});var t=r(73235),u=r(30916),i=r(15332),l=r(20958),s=r(78491);function o(){let e=(0,t._)(["\n  query RunsRootQuery($limit: Int, $cursor: String, $filter: RunsFilter!) {\n    pipelineRunsOrError(limit: $limit, cursor: $cursor, filter: $filter) {\n      ... on Runs {\n        results {\n          id\n          ...RunTableRunFragment\n        }\n      }\n      ... on InvalidPipelineRunsFilterError {\n        message\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"]);return o=function(){return e},e}function a(e,n){let{queryResult:r,paginationProps:t}=(0,i.l)({nextCursorForResult:e=>{var r;if("Runs"===e.pipelineRunsOrError.__typename)return null===(r=e.pipelineRunsOrError.results[n-1])||void 0===r?void 0:r.id},getResultArray:e=>e&&"Runs"===e.pipelineRunsOrError.__typename?e.pipelineRunsOrError.results:[],variables:{filter:e},query:d,pageSize:n});return{queryResult:r,paginationProps:t}}let d=(0,l.Ps)(o(),u.Z,s.B)},85062:function(e,n,r){"use strict";r.d(n,{Y:function(){return u}});var t=r(39013);let u=r(35505).ZP.div.withConfig({componentId:"sc-1e417a12-0"})(["thead tr{position:sticky;top:","px;background-color:",";z-index:1;}thead tr th{position:relative;}thead tr th::after{content:'';display:block;height:1px;background-color:",";position:absolute;bottom:-1px;left:0;right:0;}"],e=>{let{$top:n=0}=e;return n},t.v8(),t.wL())}}]);
//# sourceMappingURL=6268.62bb7583a537aa51.js.map