(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8778],{30733:function(e,t,n){var i=n(96738);function o(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw TypeError("Expected a function");var n=function(){var i=arguments,o=t?t.apply(this,i):i[0],a=n.cache;if(a.has(o))return a.get(o);var r=e.apply(this,i);return n.cache=a.set(o,r)||a,r};return n.cache=new(o.Cache||i),n}o.Cache=i,e.exports=o},18778:function(e,t,n){"use strict";var i,o,a,r,d,h,s,l,u,g=n(46506),p=n(41059),f=(n(2784),n(72779)),c=n(13980),m=n.n(c),y=n(60568);m().oneOfType([m().func,m().object]),m().func,m().func,m().func,m().func,m().func,m().string,m().func,m().any;var x=n(30733),b=n.n(x);n(77105),(h=l||(l={})).flagDebugConsoleLogging="flagDebugConsoleLogging",h.flagDisableWebsockets="flagDisableWebsockets",h.flagSidebarResources="flagSidebarResources",h.flagDisableAutoLoadDefaults="flagDisableAutoLoadDefaults",h.flagSettingsPage="flagSettingsPage",h.flagCodeLocationPage="flagCodeLocationPage";let w=b()(()=>(function(e){let t;try{if(t=window.localStorage.getItem(e))return JSON.parse(t)}catch(e){if("string"==typeof t)return t;return}})("DAGSTER_FLAGS")||[]);b()(e=>w().includes(e)),b()(e=>new Intl.NumberFormat(e,{minimumFractionDigits:3,maximumFractionDigits:3})),new Intl.Collator(navigator.language,{sensitivity:"base"}),(s=u||(u={})).GLOBAL="global",s.JOB="job",s.GROUP="group";let v=e=>JSON.stringify(e.path),O=e=>({path:JSON.parse(e),__typename:"AssetKey"});(0,p.H)({source:e=>e.source,target:e=>e.target,x:e=>e.x,y:e=>e.y}),o=(i={source:e=>e.source,target:e=>e.target,x:e=>e.x,y:e=>e.y}).source,a=i.target,r=i.x,d=i.y;let E=e=>/^[^@:]+@[^@:]+:.+$/.test(e),N=e=>[e.definition.repository.name,"@",e.definition.repository.location.name,":",e.definition.groupName].join(""),k=b()((e,t)=>{let n=Object.keys(t.upstream[v(e)]||{}).map(e=>O(e));return[e,...n,...n.map(e=>k(e,t)).flat()].filter((e,t,n)=>n.findIndex(t=>JSON.stringify(t)===JSON.stringify(e))===t)},(e,t)=>JSON.stringify({key:e,data:t})),j={horizontal:{ranker:"tight-tree",direction:"horizontal",marginx:100,marginy:100,ranksep:60,rankdir:"LR",edgesep:90,nodesep:-10,nodeHeight:"auto",groupPaddingTop:65,groupPaddingBottom:-15,groupRendering:"if-varied",clusterpaddingtop:100},vertical:{ranker:"tight-tree",direction:"horizontal",marginx:100,marginy:100,ranksep:20,rankdir:"TB",nodesep:40,edgesep:10,nodeHeight:"auto",groupPaddingTop:55,groupPaddingBottom:-5,groupRendering:"if-varied"}},M=(e,t)=>{try{return L(e,t)}catch(n){try{return L(e,{...t,overrides:{ranker:"longest-path"}})}catch(n){return L(e,{...t,overrides:{ranker:"network-simplex"}})}}},L=(e,t)=>{let n=new g.graphlib.Graph({compound:!0}),i=Object.assign({},j[t.direction],t.overrides||{});n.setGraph(i),n.setDefaultEdgeLabel(()=>({}));let o=e=>e,a=Object.values(e.nodes).filter(o),r=e.expandedGroups||[],d={};for(let e of a)if(e.definition.groupName){let t=N(e);d[t]=d[t]||{id:t,expanded:r.includes(t),groupName:e.definition.groupName,repositoryName:e.definition.repository.name,repositoryLocationName:e.definition.repository.location.name,bounds:{x:0,y:0,width:0,height:0}}}let h="if-varied"!==i.groupRendering||Object.keys(d).length>1;h&&Object.keys(d).forEach(e=>{r.includes(e)?n.setNode(e,{borderType:"borderRight"}):n.setNode(e,{width:P,height:110})}),a.forEach(e=>{if(!h||r.includes(N(e))){let t="auto"===i.nodeHeight?G(e.definition):{width:P,height:i.nodeHeight};n.setNode(e.id,t),h&&e.definition.groupName&&n.setParent(e.id,N(e))}});let s={},l=Object.fromEntries(Object.entries(e.nodes).map(e=>{let[t,n]=e;return[t,N(n)]}));Object.entries(e.downstream).forEach(t=>{let[i,a]=t;Object.keys(a).forEach(t=>{if(!o(e.nodes[t])&&!o(e.nodes[i]))return;let a=i,d=t,u=l[t];h&&u&&!r.includes(u)&&(d=u);let g=l[i];h&&g&&!r.includes(g)&&(a=g),a!==d&&(n.setEdge({v:a,w:d},{weight:1}),o(e.nodes[t])?o(e.nodes[i])||(s[i]=!0):s[t]=!0)})}),Object.keys(s).forEach(e=>{let i=JSON.parse(e),o=i[i.length-1]||"";n.setNode(e,S(o,t))}),g.layout(n);let u=1,p=1,f={};if(n.nodes().forEach(e=>{let t=n.node(e);if(!(null==t?void 0:t.x)||!(null==t?void 0:t.width))return;let i={x:t.x-t.width/2,y:t.y-t.height/2,width:t.width,height:t.height};E(e)?r.includes(e)||(d[e].bounds=i):f[e]={id:e,bounds:i},u=Math.max(u,t.x+t.width/2),p=Math.max(p,t.y+t.height/2)}),h){for(let e of a){let t=f[e.id];if(t&&e.definition.groupName){let n=d[N(e)];n.bounds=0===n.bounds.width?t.bounds:D(n.bounds,t.bounds)}}for(let e of Object.values(d))e.expanded&&(e.bounds=B(e.bounds,{x:15,top:i.groupPaddingTop,bottom:i.groupPaddingBottom}))}let c=[];return n.edges().forEach(e=>{let i=n.node(e.v),o=n.node(e.w);if(!i||!o)return;let a=s[e.v]?16:24,r=s[e.w]?16:24;c.push("horizontal"===t.direction?{from:{x:i.x+i.width/2,y:i.y},fromId:e.v,to:{x:o.x-o.width/2-5,y:o.y},toId:e.w}:{from:{x:i.x-i.width/2+a,y:i.y-30+i.height/2},fromId:e.v,to:{x:o.x-o.width/2+r,y:o.y+20-o.height/2},toId:e.w})}),{nodes:f,edges:c,width:u+100,height:p+100,groups:h?d:{}}},S=(e,t)=>"horizontal"===t.direction?{width:32+7.1*Math.min(30,e.length),height:50}:{width:106,height:50},B=(e,t)=>({x:e.x-t.x,y:e.y-t.top,width:e.width+2*t.x,height:e.height+t.top+t.bottom}),D=(e,t)=>{let n=Math.min(e.x,t.x),i=Math.min(e.y,t.y);return{x:n,y:i,width:Math.max(e.x+e.width,t.x+t.width)-n,height:Math.max(e.y+e.height,t.y+t.height)-i}},P=320,G=e=>{var t;let n=106;return!e.isMaterializable&&e.isObservable?n+=30:(n+=56,e.isPartitioned&&(n+=52)),(null===(t=e.changedReasons)||void 0===t?void 0:t.length)&&(n+=30),{width:P,height:n+=36}},C=e=>"result"!==e.solid.name?"".concat(e.solid.name,":").concat(e.definition.name):e.solid.name;function R(e){let t={};return e.forEach(e=>e.forEach(e=>t[C(e)]=e)),Object.values(t)}function T(e,t,n){let i=n-166,o=Math.max(200,i/e.length),a=83+Math.min(0,(i-e.length*o)/2),r=o<300?20:0,d={};return e.forEach((e,n)=>{d[C(e)]={x:a+n*o,y:t+r*(1-n%2*2)}}),d}function I(e,t){let n=t.y,i=(e,i,o)=>{let a;let r=[...e].sort((e,t)=>i(e).localeCompare(i(t))),d=0,h=null,s={},l=Math.min(35,370/(r.length+1));r.forEach((e,i)=>{let r=o(e);r!==h?(h=r,a={port:{x:t.x+d+13,y:n+13},collapsed:[],label:!1,layout:{x:t.x+d,y:n,width:35,height:26}},s[e.definition.name]=a,d+=l):(0===a.collapsed.length&&(d+=15),a.collapsed.push(e.definition.name))});let u=(370-(d-13+35))/2;return Object.values(s).forEach(e=>{e.layout.x+=u,e.port.x+=u}),n+=26,s},o=e=>{let i={};return e.forEach(e=>{i[e.definition.name]={port:{x:t.x+13,y:n+13},label:!0,collapsed:[],layout:{x:t.x,y:n,width:0,height:26}},n+=26}),i},a=e.inputs.length>4?i(e.inputs,e=>e.definition.name,e=>{var t;return(null===(t=e.dependsOn[0])||void 0===t?void 0:t.solid.name)||""}):o(e.inputs),r={x:t.x,y:Math.max(t.y,n-0),width:370,height:52};n+=52,e.definition.assetNodes.length&&e.definition.description&&(r.height+=22,n+=22);let d=e.outputs.length>4?i(e.outputs,e=>{var t;return(null===(t=e.dependedBy[0])||void 0===t?void 0:t.definition.name)||""},e=>{var t;return(null===(t=e.dependedBy[0])||void 0===t?void 0:t.solid.name)||""}):o(e.outputs);return{bounds:{x:t.x-5,y:t.y-5,width:380,height:n-t.y+10},op:r,inputs:a,outputs:d}}self.addEventListener("message",e=>{let{data:t}=e;switch(t.type){case"layoutOpGraph":{let{ops:e,opts:n}=t;self.postMessage(function(e,t){let n=new g.graphlib.Graph,i=0,o=100,a=100;t.parentOp&&(o=(a=140)+(i=26*Math.max(t.parentOp.inputs.length,t.parentOp.outputs.length))),n.setGraph({rankdir:"TB",marginx:a,marginy:o,ranker:"tight-tree"}),n.setDefaultEdgeLabel(()=>({}));let r=[],d={};e.forEach(e=>{d[e.name]=!0}),e.forEach(e=>{let t=I(e,{x:0,y:0});n.setNode(e.name,{width:t.bounds.width,height:t.bounds.height}),e.inputs.forEach(t=>{t.dependsOn.forEach(i=>{d[i.solid.name]&&d[e.name]&&(n.setEdge({v:i.solid.name,w:e.name},{weight:1}),r.push({from:{point:{x:0,y:0},opName:i.solid.name,edgeName:i.definition.name},to:{point:{x:0,y:0},opName:e.name,edgeName:t.definition.name}}))})})}),g.layout(n);let h={},s={};n.nodes().forEach(function(e){let t=n.node(e);t&&(s[e]=t)});let l=0,u=0;Object.entries(s).forEach(t=>{let[n,i]=t,o=e.find(e=>{let{name:t}=e;return t===n});if(!o)return;let a=i.x-i.width/2,r=i.y-i.height/2;h[n]=I(o,{x:a,y:r}),l=Math.max(l,a+i.width),u=Math.max(u,r+i.height)}),n.edges().forEach(function(e){let t=r.find(t=>t.from.opName===e.v&&t.to.opName===e.w),i=n.edge(e).points;t&&i.length>0&&(t.from.point=i[0],t.to.point=i[i.length-1])});let p={edges:r,nodes:h,width:l+a,height:u+o,parent:null};return t.parentOp&&(p.parent=function(e,t,n){let i={invocationBoundingBox:{x:1,y:1,width:e.width-1,height:e.height-1},bounds:{x:70,y:70+n,width:e.width-140,height:e.height-(70+n)*2},mappingLeftEdge:50,mappingLeftSpacing:10,inputs:{},outputs:{},dependsOn:T(R(t.inputs.map(e=>e.dependsOn)),-50,e.width),dependedBy:T(R(t.outputs.map(e=>e.dependedBy)),e.height+50,e.width)},o=i.bounds.y+i.bounds.height;return t.inputs.forEach((e,t)=>{i.inputs[e.definition.name]={layout:{x:i.bounds.x,y:i.bounds.y-26*t-26,width:0,height:26},collapsed:[],label:!0,port:{x:i.bounds.x+13,y:i.bounds.y-26*t-13}}}),t.outputs.forEach((e,t)=>{i.outputs[e.definition.name]={layout:{x:i.bounds.x,y:o+26*t,width:0,height:26},collapsed:[],label:!0,port:{x:i.bounds.x+13,y:o+26*t+13}}}),i}(p,t.parentOp,i)),p}(e,n));break}case"layoutAssetGraph":{let{graphData:e,opts:n}=t;self.postMessage(M(e,n))}}})}}]);
//# sourceMappingURL=8778.90751132b4651442.js.map