"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2608],{52608:function(e,t,n){n.r(t),n.d(t,{OverviewRoot:function(){return rN},default:function(){return rD}});var r=n(52322),s=n(7267),i=n(38491),o=n(14934),l=n(2784),a=n(79106),c=n(74159),d=n(16629),u=n(60129),h=n(56619),x=n(43212),p=n(39013),m=n(46100),g=n(60603),f=n(35292),j=n(88510),v=n(47933),y=n(35505),w=n(23399),b=n(16336),k=n(69737),C=n(99048),E=n(98705),S=n(44900),T=n(46318),I=n(79342),M=n(18436),P=n(75442),A=n(20171),O=n(4378),N=n(79059),D=n(17008),L=n(65822),_=n(10539);let F=e=>{let{Header:t,TabButton:n}=e;(0,k.Px)(),(0,A.j)("Overview | Assets");let{assets:s,query:i,error:u,loading:h}=(0,M.Zg)(),x=(0,b.bT)({refresh:i,intervalMs:b.dT,leading:!0}),p=l.useMemo(()=>s?function(e){let t={};return e.forEach(e=>{if(!e.definition)return;let n=e.definition.groupName,r=e.definition.repository.name,s="".concat(n,"||").concat(r),i=t[s]||{groupName:n,repositoryName:r,assets:[]};i.assets.push(e),t[s]=i}),Object.values(t)}(s):[],[s]),[m,g]=(0,O.q)({queryKey:"q",decode:e=>e.searchQuery?JSON.parse(e.searchQuery):"",encode:e=>({searchQuery:e?JSON.stringify(e):void 0})}),f=l.useMemo(()=>""===m?p:p.filter(e=>(e.groupName||R).toLowerCase().includes(m.toLowerCase())||e.repositoryName.toLowerCase().includes(m.toLowerCase())),[p,m]),y=l.useMemo(()=>{var e;return null!==(e=f.flatMap(e=>e.assets.map(e=>e.key)))&&void 0!==e?e:[]},[f]);(0,C.NY)(y,"OverviewAssetsRoot");let E=l.useRef(null),S=(0,j.MG)({count:f.length,getScrollElement:()=>E.current,estimateSize:()=>82,overscan:5}),T=S.getTotalSize(),I=S.getVirtualItems();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{style:{position:"sticky",top:0,zIndex:1},children:[(0,r.jsx)(t,{refreshState:x}),(0,r.jsxs)(o.x,{padding:{horizontal:24,vertical:16},flex:{alignItems:"center",gap:12,grow:0},children:[(0,r.jsx)(n,{selected:"assets"}),(0,r.jsx)(c.oi,{value:m,onChange:e=>{g(e.target.value)},placeholder:"Filter asset groups…"})]}),(0,r.jsx)(o.x,{padding:{horizontal:24,vertical:16},border:"top",children:(0,r.jsx)(d.b,{intent:"info",title:"This Assets tab will be removed in an upcoming release.",description:(0,r.jsxs)(r.Fragment,{children:["Use the ",(0,r.jsx)(v.rU,{to:"/asset-groups",children:"global asset lineage page"})," to view grouped asset status details."]})})})]}),h?(0,r.jsx)(o.x,{flex:{alignItems:"center",justifyContent:"center",direction:"column",grow:1},style:{width:"100%"},children:(0,r.jsx)(a.$,{purpose:"page"})}):u?(0,r.jsx)(o.x,{flex:{alignItems:"center",justifyContent:"center",direction:"column",grow:1},style:{width:"100%"},children:(0,r.jsx)(w.T9,{error:u})}):(0,r.jsx)(o.x,{flex:{direction:"column"},style:{overflow:"hidden"},children:(0,r.jsxs)(D.W2,{ref:E,children:[(0,r.jsx)(z,{}),(0,r.jsx)(D.Nh,{$totalHeight:T,children:I.map(e=>{let{index:t,key:n,size:s,start:i}=e,o=f[t];return(0,r.jsx)($,{start:i,height:s,group:o},n)})})]})})]})},B="5fr 1fr 1fr 1fr 1fr",z=()=>(0,r.jsxs)(D.VJ,{templateColumns:B,sticky:!0,children:[(0,r.jsx)(D.qN,{children:"Group name"}),(0,r.jsx)(D.qN,{children:"Missing"}),(0,r.jsx)(D.qN,{children:"Failed/Overdue"}),(0,r.jsx)(D.qN,{children:"In progress"}),(0,r.jsx)(D.qN,{children:"Materialized"})]}),R="Ungrouped Assets";function $(e){var t,n;let{height:s,start:i,group:c}=e,d=l.useMemo(()=>c.assets.map(e=>({path:e.key.path})),[c.assets]),{liveDataByNode:m}=(0,C.NY)(d),g=l.useMemo(()=>(0,T.s)(c.assets,m),[m,c.assets]),f=null===(n=c.assets.find(e=>{var t;return null===(t=e.definition)||void 0===t?void 0:t.repository}))||void 0===n?void 0:null===(t=n.definition)||void 0===t?void 0:t.repository,j=(0,L.kQ)((null==f?void 0:f.name)||"",(null==f?void 0:f.location.name)||""),{containerProps:y,viewport:w}=(0,u.S)(),b=d.length!==Object.keys(m).length,k=b?"":"0";return(0,r.jsx)(D.X2,{$height:s,$start:i,children:(0,r.jsxs)(U,{border:"bottom",children:[(0,r.jsx)(q,{children:(0,r.jsxs)(o.x,{flex:{direction:"row",justifyContent:"space-between",grow:1},children:[(0,r.jsxs)(o.x,{flex:{direction:"column",gap:2,grow:1},children:[(0,r.jsxs)(o.x,{flex:{direction:"row",gap:8},children:[(0,r.jsx)(h.JO,{name:"asset_group"}),c.groupName?(0,r.jsx)(v.rU,{style:{fontWeight:700},to:(0,_.$U)(j,"/asset-groups/".concat(c.groupName)),children:c.groupName}):R]}),(0,r.jsx)("div",{...y,children:(0,r.jsx)(K,{maxWidth:w.width,children:(0,r.jsx)(N.b,{repoAddress:j,showRefresh:!1})})})]}),(0,r.jsx)(o.x,{flex:{direction:"column",justifyContent:"center"},children:b?(0,r.jsx)(a.$,{purpose:"body-text"}):null})]})}),(0,r.jsx)(q,{children:g.missing.length?(0,r.jsx)(H,{assets:g.missing,getCount:e=>{let{status:t}=e;return t.case===E.KB.PARTITIONS_MISSING&&t.numMissing||0},adjective:"missing",children:(0,r.jsx)(x.V,{intent:"none",children:(0,r.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:6},children:[(0,r.jsx)("div",{style:{width:"12px",height:"12px",border:"2px solid ".concat(p.im()),borderRadius:"50%"}}),g.missing.length]})})}):k}),(0,r.jsx)(q,{children:g.failed.length?(0,r.jsx)(H,{assets:g.failed,getCount:e=>{let{status:t}=e;return t.case===E.KB.PARTITIONS_FAILED&&t.numFailed||0},adjective:"failed",children:(0,r.jsx)(x.V,{intent:"danger",children:(0,r.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:6},children:[(0,r.jsx)("div",{style:{width:0,height:0,borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderBottom:"10px solid red",display:"inline-block"}}),g.failed.length]})})}):k}),(0,r.jsx)(q,{children:g.inprogress.length?(0,r.jsx)(H,{assets:g.inprogress,getCount:e=>{let{status:t}=e;return t.case===E.KB.MATERIALIZING&&t.numMaterializing||0},adjective:"materializing",children:(0,r.jsx)(x.V,{intent:"primary",icon:"spinner",children:g.inprogress.length})}):k}),(0,r.jsx)(q,{children:g.successful.length?(0,r.jsx)(H,{assets:g.successful,getCount:e=>{let{status:t}=e;return t.case===E.KB.PARTITIONS_MATERIALIZED&&t.numMaterialized||0},adjective:"materialized",children:(0,r.jsx)(x.V,{intent:"success",children:(0,r.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:6},children:[(0,r.jsx)("div",{style:{backgroundColor:p.fA(),width:"10px",height:"10px",borderRadius:"50%"}}),g.successful.length]})})}):k})]})})}let U=(0,y.ZP)(o.x).withConfig({componentId:"sc-9ca8ef04-0"})(["display:grid;grid-template-columns:",";height:100%;> *{vertical-align:middle;}"],B),q=e=>{let{children:t}=e;return(0,r.jsx)(D.E5,{style:{color:p.Ep()},children:(0,r.jsx)(o.x,{flex:{direction:"row",alignItems:"center",grow:1},children:t})})},K=y.ZP.div.withConfig({componentId:"sc-9ca8ef04-1"})(["font-size:12px;pointer-events:none;a{color:",";pointer-events:none;max-width:",";}"],p.$(),e=>{let{maxWidth:t}=e;return t?"unset":"".concat(t,"px")});function H(e){let{assets:t,children:n,getCount:s,adjective:i}=e;return(0,r.jsx)(V,{children:(0,r.jsx)(m.P,{items:t,itemPredicate:(e,t)=>(0,S.ll)(t.asset.key).toLocaleLowerCase().includes(e.toLocaleLowerCase()),itemRenderer:e=>{let t=s(e);return(0,r.jsx)(J,{to:(0,P.p)(e.asset.key),target:"_blank",children:(0,r.jsx)(g.sN,{text:(0,r.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:4},children:[(0,r.jsx)("div",{style:{paddingLeft:"4px"},children:(0,r.jsx)(h.JO,{name:"asset"})}),(0,r.jsx)("div",{style:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:(0,S.ll)(e.asset.key)}),t&&t>0?(0,r.jsxs)(f.YS,{style:{color:p.$()},children:[(0,I._e)(t)," ",i]}):null]})},(0,S.ll)(e.asset.key))})},onItemSelect:()=>{},children:n})})}let V=y.ZP.div.withConfig({componentId:"sc-9ca8ef04-2"})(["cursor:pointer;&:hover{font-weight:600;}"]),J=(0,y.ZP)(v.rU).withConfig({componentId:"sc-9ca8ef04-3"})(["&:hover{text-decoration:none;}"]);var Q=n(74580);let W=()=>null;var Y=n(73407),G=n(49438),Z=n(87171),X=n(39268),ee=n(71348),et=n(89918);let en=e=>{let{refreshState:t,tab:n}=e,{flagSettingsPage:s}=(0,G.gV)(),i=(0,ee.dx)(),c=(0,X.I)(),{enableAssetHealthOverviewPreview:d}=(0,l.useContext)(Z.G);return(0,r.jsxs)(o.x,{flex:{direction:"row",justifyContent:"space-between",alignItems:"flex-end"},children:[(0,r.jsxs)(Y.mQ,{selectedTabId:n,children:[(0,r.jsx)(et.f,{id:"activity",title:"Timeline",to:"/overview/activity"}),d&&(0,r.jsx)(et.f,{id:"asset-health",title:"Asset health",to:"/overview/asset-health"}),s?null:(0,r.jsx)(et.f,{id:"jobs",title:"Jobs",to:"/overview/jobs"}),s?null:(0,r.jsx)(et.f,{id:"schedules",title:"Schedules",to:"/overview/schedules"}),s?null:(0,r.jsx)(et.f,{id:"sensors",title:"Sensors",to:"/overview/sensors"}),"has-global-amp"===c?(0,r.jsx)(et.f,{id:"amp",title:(0,r.jsxs)(o.x,{flex:{direction:"row",gap:8,alignItems:"center"},children:[(0,r.jsx)("div",{children:"Auto-materialize"}),i.loading?(0,r.jsx)(a.$,{purpose:"body-text"}):(0,r.jsx)("div",{style:{width:"10px",height:"10px",borderRadius:"50%",backgroundColor:!1===i.paused?p.L$():p.md()}})]}),to:"/overview/automation"}):null,(0,r.jsx)(et.f,{id:"resources",title:"Resources",to:"/overview/resources"}),(0,r.jsx)(et.f,{id:"backfills",title:"Backfills",to:"/overview/backfills"})]}),t?(0,r.jsx)(o.x,{style:{alignSelf:"center"},children:(0,r.jsx)(b.xi,{refreshState:t})}):null]})},er=e=>{let{tab:t,queryData:n,refreshState:s,...i}=e;return(0,r.jsx)(Q.m,{tabs:(0,r.jsxs)(o.x,{flex:{direction:"column",gap:8},children:[(0,r.jsx)(en,{tab:t,queryData:n,refreshState:s}),(0,r.jsx)(W,{})]}),...i})};var es=n(51484),ei=n(43111),eo=n(71406);let el=e=>{let{value:t,onSelect:n}=e;return(0,r.jsx)(m.P,{items:["automation","job"],itemRenderer:(e,t)=>(0,r.jsx)(g.sN,{icon:ec(e),text:ea(e),onClick:t.handleClick},e),onItemSelect:n,filterable:!1,children:(0,r.jsx)(i.zx,{icon:(0,r.jsx)(h.JO,{name:ec(t)}),rightIcon:(0,r.jsx)(h.JO,{name:"arrow_drop_down"}),children:ea(t)})})},ea=e=>{switch(e){case"automation":return"Automation";case"job":return"Job";default:return(0,eo.UT)(e)}},ec=e=>{switch(e){case"automation":return"sensors";case"job":return"job";default:return(0,eo.UT)(e)}};var ed=n(22563);let eu=e=>{let t={};for(let n of e){let{repoAddress:e,runs:r}=n;r.forEach(n=>{let{automation:r}=n,s=ex(e,r);if(!t[s]){let n=eh(r);t[s]={key:s,name:n,type:(null==r?void 0:r.type)||"manual",path:ep(e,null==r?void 0:r.type,n),repoAddress:e,runs:[]}}t[s].runs.push(n)})}return Object.values(t)},eh=e=>{if(!e)return"Launched manually";let{type:t}=e;switch(t){case"legacy-amp":return"Auto-materialized";case"schedule":case"sensor":return e.name;default:return(0,eo.UT)(t)}},ex=(e,t)=>{let n=(0,ed.Uz)(e);if(!t)return"MANUAL-".concat(n);let{type:r}=t;switch(r){case"legacy-amp":return"AMP-".concat(n);case"schedule":case"sensor":return"".concat(t.name,"-").concat(r,"-").concat(n);default:return(0,eo.UT)(r)}},ep=(e,t,n)=>"schedule"===t?(0,_.$U)(e,"/schedules/".concat(n)):"sensor"===t?(0,_.$U)(e,"/sensors/".concat(n)):"";var em=n(69021);let eg=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"job",t=(0,l.useCallback)(t=>{switch(t){case"job":case"automation":return t;default:return e}},[e]),[n,r]=(0,em.j)({localStorageKey:"dagster.run-timeline-group-by",queryKey:"groupBy",encode:e=>({groupBy:e}),decode:e=>t(e.groupBy),isEmptyState:e=>!e}),s=(0,l.useCallback)(t=>{r(t||e)},[e,r]);return(0,l.useMemo)(()=>[n,s],[n,s])};var ef=n(43250),ej=n(35002),ev=n(74188),ey=n(53664),ew=n(55010),eb=n(54516),ek=n(59351);let eC=e=>{let{type:t}=e;switch(t){case"asset":return(0,r.jsx)(h.JO,{name:"asset"});case"job":return(0,r.jsx)(h.JO,{name:"job"});case"manual":return(0,r.jsx)(h.JO,{name:"account_circle"});case"schedule":return(0,r.jsx)(h.JO,{name:"schedule"});case"sensor":case"legacy-amp":return(0,r.jsx)(h.JO,{name:"sensors"});default:return(0,eo.UT)(t)}};var eE=n(2278);let eS=(e,t)=>!(e.end<t.start||t.end<e.start),eT=e=>{let{runs:t,start:n,end:r,width:s,minChunkWidth:i,minMultipleWidth:o}=e,l=r-n,a=(Date.now()-n)/(r-n)*s+1,c=t.map(e=>{let t=e.startTime,r=e.endTime||Date.now();return{runs:[e],startTime:t,endTime:r,left:Math.max(0,Math.floor((t-n)/l*s)),width:Math.max(i,Math.min(Math.ceil((r-t)/l*s),Math.ceil((r-n)/l*s)))}}).sort((e,t)=>e.left-t.left),d=[];for(;c.length;){let e=c.shift(),t=c[0];if(e){if(t&&eI(e,t,o,a)){c.shift(),e.runs=[...e.runs,...t.runs],e.startTime=Math.min(e.startTime,t.startTime),e.endTime=Math.max(e.endTime,t.endTime);let n=Math.max(e.left+o,e.left+e.width,t.left+t.width),r=Math.min(e.left,t.left);e.width=n-r,e.left=r,c.unshift(e)}else d.push(e)}}return d},eI=(e,t,n,r)=>{let s=e.left,i=e.left+Math.max(e.width,n),o=t.left,l=t.left+Math.max(t.width,n),a=Math.min(e.left,t.left),c=Math.max(e.left+Math.max(e.width,n),t.left+Math.max(t.width,n));return eS({start:s,end:i},{start:o,end:l})&&(a>r||c<r)},eM=e=>{switch(e){case"queued":case"scheduled":return p.A8();case"inProgress":return p.L$();case"failed":return p.FY();case"succeeded":return p.fA()}},eP=e=>{let t={scheduled:0,queued:0,inProgress:0,failed:0,succeeded:0};e.forEach(e=>{let{status:n}=e;"SCHEDULED"===n?t.scheduled++:ek.sy.has(n)?t.queued++:ek.Ys.has(n)?t.inProgress++:ek.hd.has(n)?t.failed++:ek._m.has(n)&&t.succeeded++});let n=Object.keys(t).filter(e=>t[e]>0);if(1===n.length){let[e]=n;return eM(e)}let r=e.length,s=[t.failed>0?{status:"failed",pct:100*t.failed/r}:null,t.succeeded>0?{status:"succeeded",pct:100*t.succeeded/r}:null,t.inProgress>0?{status:"inProgress",pct:100*t.inProgress/r}:null,t.queued>0?{status:"queued",pct:100*t.queued/r}:null,t.scheduled>0?{status:"scheduled",pct:100*t.scheduled/r}:null].filter(Boolean),i="",o=0,l=0;for(let e=0;e<s.length;e++){let t=s[e];if(!t)continue;let{status:n,pct:r}=t;l=o,o+=r;let a=eM(n);0===e?i+="".concat(a," ").concat(r.toFixed(1),"%, "):e===s.length-1?i+="".concat(a," ").concat(l.toFixed(1),"%"):i+="".concat(a," ").concat(l.toFixed(1),"% ").concat(o.toFixed(1),"%, ")}return"linear-gradient(to right, ".concat(i,")")};var eA=n(22921),eO=n(86269),eN=n(88610),eD=n(98956),eL=n(82145),e_=n(50646),eF=n(94853),eB=n(83738),ez=n(4199);let eR={asset:0,manual:0,"legacy-amp":0,schedule:1,sensor:1,job:2},e$=e=>{let{loading:t=!1,rows:n,rangeMs:s}=e,i=l.useRef(null),{viewport:{width:a},containerProps:{ref:c}}=(0,u.S)(),d=Date.now(),[h,x]=s,p=l.useMemo(()=>n.reduce((e,t)=>{let{repoAddress:n}=t,r=(0,ed.Qj)(n);return e[r]=e[r]||[],e[r].push(t),e},{}),[n]),m=Object.keys(p),{expandedKeys:g,onToggle:f,onToggleAll:v}=(0,e_.N)(eA.y,m),y=l.useMemo(()=>{let e=[];return Object.entries(p).sort((e,t)=>eo.Bl.compare(e[0],t[0])).forEach(t=>{let[n,r]=t,s=(0,ez.g)(n);s&&(e.push({type:"header",repoAddress:s,rowCount:r.length}),g.includes(n)&&r.sort((e,t)=>eR[e.type]-eR[t.type]||eo.Bl.compare(e.name,t.name)).forEach(t=>{e.push({type:t.type,repoAddress:s,row:t})}))}),e},[p,g]),w=(0,j.MG)({count:y.length,getScrollElement:()=>i.current,estimateSize:e=>32,overscan:40}),b=w.getTotalSize(),k=w.getVirtualItems();if(!a)return(0,r.jsx)("div",{style:{height:174},ref:c});let C=Object.keys(p).sort((e,t)=>e.localeCompare(t)),E=C.filter(e=>g.includes(e)).reduce((e,t)=>e+p[t].length,0),S=C.length*eF.l+32*E,T=(0,eD.w)(C.map(e=>{var t;return(null===(t=(0,ez.g)(e))||void 0===t?void 0:t.name)||""})),I=C.length>0;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{ref:c}),(0,r.jsx)(o.x,{padding:{left:24},flex:{direction:"column",justifyContent:"center"},style:{fontSize:"16px",flex:"0 0 ".concat(64,"px")},border:"top-and-bottom",children:"Runs"}),(0,r.jsx)("div",{style:{position:"relative"},children:(0,r.jsx)(eY,{interval:36e5,rangeMs:s,height:I?S:0})}),C.length?(0,r.jsx)("div",{style:{overflow:"hidden",position:"relative"},children:(0,r.jsx)(D.W2,{ref:i,children:(0,r.jsx)(D.Nh,{$totalHeight:b,children:k.map(e=>{let{index:t,key:n,size:i,start:o}=e,l=y[t];if("header"===l.type){let e=(0,ed.Qj)(l.repoAddress),t=l.repoAddress.name;return(0,r.jsx)(eU,{expanded:g.includes(e),height:i,top:o,repoAddress:l.repoAddress,isDuplicateRepoName:!!(t&&T.has(t)),rows:p[e],onToggle:f,onToggleAll:v},e)}return(0,r.jsx)(e4,{row:l.row,height:i,top:o,rangeMs:s,width:a},n)})})})}):(0,r.jsx)(e6,{loading:t,includesTicks:d<=x})]})},eU=e=>{let{expanded:t,onToggle:n,onToggleAll:s,repoAddress:i,isDuplicateRepoName:o,rows:l,height:a,top:c}=e;return(0,r.jsx)(eB.vG,{expanded:t,height:a,start:c,repoAddress:i,showLocation:o,onToggle:n,onToggleAll:s,rightElement:(0,r.jsx)(eq,{rows:l})})},eq=l.memo(e=>{let{rows:t}=e,n=l.useMemo(()=>{let e=0,n=0,r=0;return t.forEach(t=>{let{runs:s}=t;s.forEach(t=>{let{status:s}=t;"SCHEDULED"!==s&&(ek.Ys.has(s)?e++:ek.hd.has(s)?n++:ek._m.has(s)&&r++)})}),{inProgressCount:e,failedCount:n,succeededCount:r}},[t]);return(0,r.jsx)(eK,{...n})}),eK=e=>{let{inProgressCount:t,succeededCount:n,failedCount:s}=e,i=1===t?"1 run in progress":"".concat(t," runs in progress"),l=1===n?"1 run succeeded":"".concat(n," runs succeeded"),a=1===s?"1 run failed":"".concat(s," runs failed");return(0,r.jsxs)(o.x,{flex:{direction:"row",gap:4,alignItems:"center"},children:[t>0?(0,r.jsx)(ej.u,{content:(0,r.jsx)(eH,{children:i}),placement:"top",children:(0,r.jsx)(x.V,{intent:"primary",children:t})}):null,n>0?(0,r.jsx)(ej.u,{content:(0,r.jsx)(eH,{children:l}),placement:"top",children:(0,r.jsx)(x.V,{intent:"success",children:n})}):null,s>0?(0,r.jsx)(ej.u,{content:(0,r.jsx)(eH,{children:a}),placement:"top",children:(0,r.jsx)(x.V,{intent:"danger",children:s})}):null]})},eH=y.ZP.span.withConfig({componentId:"sc-d8513d0e-0"})(["white-space:nowrap;"]),eV={month:"numeric",day:"numeric",year:"numeric"},eJ={month:"short",day:"numeric",year:"numeric",timeZoneName:"short"},eQ={hour:"numeric",minute:"numeric"},eW={hour:"numeric"},eY=e=>{let{interval:t,rangeMs:n,annotations:s,height:i,now:a}=e,[c,d]=n,u=(0,eL.O)(),h=(0,l.useMemo)(()=>new Date(u(new Date(c),eJ,"en-US")),[u,c]),x=l.useMemo(()=>{let e=d-c,t=[],n=h;for(;n.valueOf()<d;){let e=n.getTime(),r=new Date(e).setDate(n.getDate()+1);n=new Date(r),t.push({dayStart:e,dayEnd:r})}return t.map(t=>{let{dayStart:n,dayEnd:r}=t,s=new Date(n),i=n-c,o=r-n,l=Math.max(0,i/e*100);return{label:u(s,eV),key:s.toString(),left:l,width:Math.min(100,(i+o)/e*100)-l}})},[h,d,u,c]),m=l.useMemo(()=>{let e=d-c,n=[],r=h;for(;r.valueOf()<d;){let e=r.getTime();r=new Date(new Date(e).setTime(r.getTime()+t)),n.push(e)}return n.map(n=>{let r=new Date(n),s=n-c;return{label:t<36e5?u(r,eQ).replace(" ",""):u(r,eW).replace(" ",""),key:r.toString(),left:Math.max(0,s/e*100)}}).filter(e=>e.left>0)},[d,c,h,t,u]),g=a||Date.now(),f=e=>"".concat(((e-c)/(d-c)*100).toPrecision(3),"%");return(0,r.jsxs)(eG,{style:{height:"".concat(i,"px"),top:"-".concat(64,"px")},children:[(0,r.jsx)(eZ,{children:x.map(e=>(0,r.jsx)(eX,{style:{left:"".concat(e.left.toPrecision(3),"%"),width:"".concat(e.width.toPrecision(3),"%")},children:e.width>10?(0,r.jsx)(o.x,{flex:{justifyContent:"center"},children:e.label}):null},e.key))}),(0,r.jsx)(eZ,{children:m.map(e=>(0,r.jsx)(e0,{style:{left:"".concat(e.left.toPrecision(3),"%")},children:e.label},e.key))}),(0,r.jsxs)(e1,{children:[(0,r.jsx)(e2,{style:{left:0,backgroundColor:p.wL()}}),m.map(e=>(0,r.jsx)(e2,{style:{left:"".concat(e.left.toPrecision(3),"%")}},e.key)),g>=c&&g<=d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e3,{style:{left:f(g)},children:"Now"}),(0,r.jsx)(e2,{style:{left:f(g),backgroundColor:p.Bj(),zIndex:1}})]}):null,(s||[]).filter(e=>e.ms>=c&&e.ms<=d).map(e=>(0,r.jsxs)(l.Fragment,{children:[(0,r.jsx)(e3,{style:{left:f(e.ms)},children:e.label}),(0,r.jsx)(e2,{style:{left:f(e.ms),backgroundColor:p.Bj(),zIndex:1}})]},e.label))]})]})},eG=y.ZP.div.withConfig({componentId:"sc-d8513d0e-1"})(["position:absolute;top:0;left:","px;right:0;font-family:",";color:",";"],320,ev.b.monospace,p.Aw()),eZ=y.ZP.div.withConfig({componentId:"sc-d8513d0e-2"})(["display:flex;align-items:center;box-shadow:inset 1px 0 0 ",",inset 0 1px 0 ",",inset -1px 0 0 ",";height:","px;position:relative;user-select:none;font-size:12px;width:100%;overflow:hidden;:first-child{box-shadow:inset 1px 0 0 ",",inset -1px 0 0 ",";}"],p.wL(),p.wL(),p.wL(),32,p.wL(),p.wL()),eX=y.ZP.div.withConfig({componentId:"sc-d8513d0e-3"})(["position:absolute;padding:8px 0;white-space:nowrap;:not(:first-child){box-shadow:inset 1px 0 0 ",";}"],p.wL()),e0=y.ZP.div.withConfig({componentId:"sc-d8513d0e-4"})(["position:absolute;padding:8px;box-shadow:inset 1px 0 0 ",";white-space:nowrap;"],p.wL()),e1=y.ZP.div.withConfig({componentId:"sc-d8513d0e-5"})(["height:100%;position:relative;width:100%;box-shadow:inset 1px 0 0 ",",inset -1px 0 0 ",";"],p.wL(),p.wL()),e2=y.ZP.div.withConfig({componentId:"sc-d8513d0e-6"})(["background-color:",";height:100%;position:absolute;top:0;width:1px;"],p.wL()),e3=y.ZP.div.withConfig({componentId:"sc-d8513d0e-7"})(["background-color:",";border-radius:1px;color:",";cursor:default;font-size:10px;line-height:12px;transform:translate(-50%,0);padding:1px 4px;position:absolute;top:-14px;user-select:none;"],p.Bj(),p.KH()),e4=e=>{let{row:t,top:n,height:s,rangeMs:i,width:a}=e,[c,d]=i,u=a-320,{runs:h}=t,x=l.useMemo(()=>eT({runs:h,start:c,end:d,width:u,minChunkWidth:4,minMultipleWidth:12}),[h,c,d,u]);return t.runs.length?(0,r.jsxs)(e8,{$height:s,$start:n,children:[(0,r.jsxs)(e5,{children:[(0,r.jsx)(eC,{type:t.type}),(0,r.jsx)("div",{style:{width:268},children:t.path?(0,r.jsx)(v.rU,{to:t.path,children:(0,r.jsx)(ey.g,{text:t.name})}):(0,r.jsx)("span",{style:{color:p.Ep()},children:(0,r.jsx)(ey.g,{text:t.name})})})]}),(0,r.jsx)(e9,{children:x.map(e=>{let{left:n,width:s,runs:i}=e,l=i.length;return(0,r.jsx)(e7,{$background:eP(e.runs),$multiple:l>1,style:{left:"".concat(n,"px"),width:"".concat(s,"px")},children:(0,r.jsx)(ew.J,{content:(0,r.jsx)(tt,{row:t,batch:e}),position:"top",interactionKind:"hover",className:"chunk-popover-target",children:(0,r.jsx)(o.x,{flex:{direction:"row",justifyContent:"center",alignItems:"center"},style:{height:"100%"},children:l>1?(0,r.jsx)(te,{children:e.runs.length}):null})})},e.runs[0].id)})})]}):null},e6=e=>{let{loading:t,includesTicks:n}=e;return(0,r.jsx)(o.x,{background:p.v8(),padding:{vertical:24},flex:{direction:"row",justifyContent:"center"},border:"top-and-bottom",children:t?(0,r.jsxs)(o.x,{flex:{direction:"row",gap:8,alignItems:"center"},children:[(0,r.jsx)(a.$,{purpose:"body-text"}),n?"Loading runs and scheduled ticks":"Loading runs"]}):(0,r.jsxs)(o.x,{flex:{direction:"column",gap:12,alignItems:"center"},children:[(0,r.jsx)("div",{children:n?"No runs or scheduled ticks in this time period.":"No runs in this time period."}),(0,r.jsxs)(o.x,{flex:{direction:"row",gap:12,alignItems:"center"},children:[(0,r.jsx)(eN.A,{icon:(0,r.jsx)(h.JO,{name:"add_circle"}),to:"/overview/jobs",children:"Launch a run"}),(0,r.jsx)("span",{children:"or"}),(0,r.jsx)(eN.A,{icon:(0,r.jsx)(h.JO,{name:"materialization"}),to:"/asset-groups",children:"Materialize an asset"})]})]})})},e8=y.ZP.div.attrs(e=>{let{$height:t,$start:n}=e;return{style:{height:"".concat(t,"px"),transform:"translateY(".concat(n,"px)")}}}).withConfig({componentId:"sc-d8513d0e-8"})(["align-items:center;box-shadow:inset 0 -1px 0 ",";display:flex;flex-direction:row;width:100%;padding:1px 0;left:0;position:absolute;right:0;top:0;overflow:hidden;transition:background-color 100ms linear;:hover{background-color:",";}"],p.wL(),p.Z$()),e5=y.ZP.div.withConfig({componentId:"sc-d8513d0e-9"})(["align-items:center;display:flex;font-size:13px;justify-content:flex-start;gap:8px;line-height:16px;overflow:hidden;padding:0 12px 0 24px;text-overflow:ellipsis;white-space:nowrap;width:","px;"],320),e9=y.ZP.div.withConfig({componentId:"sc-d8513d0e-10"})(["flex:1;position:relative;height:","px;"],32),e7=y.ZP.div.withConfig({componentId:"sc-d8513d0e-11"})(["align-items:center;background:",";border-radius:1px;height:","px;position:absolute;top:4px;",";transition:background 200ms linear,opacity 200ms linear,width 200ms ease-in-out;:hover{opacity:0.7;}.chunk-popover-target{display:block;height:100%;width:100%;}"],e=>{let{$background:t}=e;return t},24,e=>{let{$multiple:t}=e;return t?"min-width: ".concat(12,"px"):null}),te=y.ZP.div.withConfig({componentId:"sc-d8513d0e-12"})(["color:",";cursor:default;font-family:",";font-size:12px;font-weight:600;user-select:none;"],p.KH(),ev.b.monospace),tt=e=>{let{row:t,batch:n}=e,s=n.runs.slice(0,50),i=n.runs.length-s.length;return(0,r.jsxs)(o.x,{style:{width:"260px"},children:[(0,r.jsxs)(o.x,{padding:12,border:"bottom",flex:{direction:"row",gap:8,alignItems:"center"},children:[(0,r.jsx)(eC,{type:t.type}),(0,r.jsx)(tn,{children:t.name})]}),(0,r.jsx)("div",{style:{maxHeight:"240px",overflowY:"auto"},children:s.map((e,t)=>(0,r.jsxs)(o.x,{border:t>0?"top":null,flex:{direction:"row",justifyContent:"space-between",alignItems:"center"},padding:{vertical:8,horizontal:12},children:[(0,r.jsxs)(o.x,{flex:{direction:"row",gap:8,alignItems:"center"},children:[(0,r.jsx)(eb.O_,{status:e.status,size:8}),"SCHEDULED"===e.status?"Scheduled":(0,r.jsx)(v.rU,{to:"/runs/".concat(e.id),children:(0,r.jsx)(f.fv,{children:e.id.slice(0,8)})})]}),(0,r.jsx)(f.fv,{children:"SCHEDULED"===e.status?(0,r.jsx)(eO.v,{timestamp:e.startTime/1e3}):(0,r.jsx)(eE.Q,{startUnix:e.startTime/1e3,endUnix:e.endTime/1e3})})]},e.id))}),i>0?(0,r.jsx)(o.x,{padding:12,border:"top",children:(0,r.jsxs)(v.rU,{to:"".concat(t.path,"/runs"),children:["+ ",i," more"]})}):null]})},tn=y.ZP.strong.withConfig({componentId:"sc-d8513d0e-13"})(["display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%;"]);var tr=n(30001);let ts=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"dagster.run-timeline-hour-window",n=(0,l.useCallback)(t=>{switch(t){case"1":case"6":case"12":case"24":return t;default:return e}},[e]),[r,s]=(0,tr.U)(t,n),i=(0,l.useCallback)(t=>{s(t||e)},[e,s]);return(0,l.useMemo)(()=>[r,i],[r,i])};var ti=n(73235),to=n(13394);let tl={expiry:new Date("3030-01-01")};class ta{async loadCacheFromIndexedDB(){return this.indexedDBCache?(this.loadPromise||(this.loadPromise=new Promise(async e=>{if(!this.indexedDBCache)return;if(!await this.indexedDBCache.has(this.indexedDBKey)){e();return}let t=await this.indexedDBCache.get(this.indexedDBKey);t&&t.value.version===this.version&&(this.cache=new Map(t.value.cache)),e()})),await this.loadPromise):void 0}async saveCacheToIndexedDB(){if("undefined"!=typeof jest){if(!this.indexedDBCache)return;this.indexedDBCache.set(this.indexedDBKey,{version:this.version,cache:this.cache},tl);return}clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout(()=>{this.indexedDBCache&&this.indexedDBCache.set(this.indexedDBKey,{version:this.version,cache:this.cache},tl)},1e4),this.registeredUnload||(this.registeredUnload=!0,window.addEventListener("beforeunload",()=>{this.indexedDBCache&&this.indexedDBCache.set(this.indexedDBKey,{version:this.version,cache:this.cache},tl)}))}async clearOldEntries(){let e=Math.floor((Date.now()-6048e5)/36e5);for(let t of(await this.loadCacheFromIndexedDB(),this.cache.keys()))t<e&&this.cache.delete(t)}addData(e,t,n){let r=Math.floor(e/3600);if(Math.floor(t/3600)-r>1)throw Error("Expected all data to fit within an hour");this.addPartialData(r,e,t,n),this.notifySubscribers(r),this.saveCacheToIndexedDB()}addPartialData(e,t,n,r){this.cache.has(e)||this.cache.set(e,[]),this.cache.get(e).push({start:t,end:n,data:r}),this.cache.set(e,this.mergeIntervals(this.cache.get(e)))}getHourData(e){let t=Math.floor(e/3600);return this.cache.has(t)?this.cache.get(t).flatMap(e=>e.data):[]}getMissingIntervals(e){let t=Math.floor(e/3600);if(this.cache.has(t)&&1===this.cache.get(t).length&&this.cache.get(t)[0].end-this.cache.get(t)[0].start==3600)return[];let n=[],r=3600*t,s=(t+1)*3600,i=r;if(this.cache.has(t))for(let{start:e,end:r}of this.cache.get(t))e>i&&n.push([i,e]),i=Math.max(i,r);return i<s&&n.push([i,s]),n}isCompleteRange(e,t){let n=Math.floor(e/3600);if(Math.floor(t/3600)-n>1)throw Error("Expected the input range to be within a single hour");if(this.cache.has(n)){let r=this.cache.get(n),s=e;for(let{start:e,end:n}of r){if(e>s)return!1;if(n>=t)return!0;s=Math.max(s,n)}return s>=t}return!1}mergeIntervals(e){if(0===e.length)return[];e.sort((e,t)=>e.start-t.start);let t=[e[0]];for(let n of e.slice(1)){let e=t[t.length-1];n.start<=e.end?(e.end=Math.max(e.end,n.end),e.data=e.data.concat(n.data)):t.push(n)}return t}subscribe(e,t){let n=Math.floor(e/3600),r={hour:n,callback:t};return this.subscriptions.push(r),this.notifyExistingData(n,t),()=>{this.subscriptions=this.subscriptions.filter(e=>e!==r)}}notifySubscribers(e){for(let{hour:t,callback:n}of this.subscriptions)e>=t&&n(this.getCombinedData(t))}notifyExistingData(e,t){let n=this.getCombinedData(e);n.length>0&&t(n)}getCombinedData(e){let t=[];for(let[n,r]of this.cache)n>=e&&(t=t.concat(r.flatMap(e=>e.data)));return t}constructor({id:e,keyPrefix:t="",keyMaxCount:n=1,version:r}){this.cache=new Map,this.subscriptions=[],this.registeredUnload=!1,this.version=r,this.indexedDBKey=t?"".concat(t,"-hourlyData"):"hourlyData",e&&(this.indexedDBCache=(0,to.F)({dbName:"HourlyDataCache:".concat(e),maxCount:n}),this.loadCacheFromIndexedDB(),this.clearOldEntries())}}var tc=n(33182),td=n(96961),tu=n(43984);let th=(e,t)=>{let{tags:n=[]}=t;for(let t of n){if(t.key===tu.H.ScheduleName)return{type:"schedule",repoAddress:e,name:t.value};if(t.key===tu.H.SensorName)return{type:"sensor",repoAddress:e,name:t.value};if(t.key===tu.H.Automaterialize)return{type:"legacy-amp"}}return null},tx="a551b5ebeb919ea7ea4ca74385d3711d6a7e4f0e4042c04ab43bf9b939f4975c";var tp=n(20958),tm=n(4128),tg=n(88257);function tf(){let e=(0,ti._)(["\n  fragment ScheduleFutureTicksFragment on Schedule {\n    id\n    executionTimezone\n    scheduleState {\n      id\n      status\n    }\n    futureTicks(cursor: $tickCursor, until: $ticksUntil) {\n      results {\n        timestamp\n      }\n    }\n  }\n"]);return tf=function(){return e},e}let tj=(0,tp.Ps)(tf());var tv=n(34219);function ty(){let e=(0,ti._)(["\n  fragment RunTimelineFragment on Run {\n    id\n    pipelineName\n    tags {\n      key\n      value\n    }\n    repositoryOrigin {\n      id\n      repositoryName\n      repositoryLocationName\n    }\n    ...RunTimeFragment\n  }\n  ","\n"]);return ty=function(){return e},e}function tw(){let e=(0,ti._)(["\n  query OngoingRunTimelineQuery($inProgressFilter: RunsFilter!, $limit: Int!, $cursor: String) {\n    ongoing: runsOrError(filter: $inProgressFilter, limit: $limit, cursor: $cursor) {\n      ... on Runs {\n        results {\n          id\n          ...RunTimelineFragment\n        }\n      }\n    }\n  }\n\n  ","\n"]);return tw=function(){return e},e}function tb(){let e=(0,ti._)(["\n  query CompletedRunTimelineQuery($completedFilter: RunsFilter!, $limit: Int!, $cursor: String) {\n    completed: runsOrError(filter: $completedFilter, limit: $limit, cursor: $cursor) {\n      ... on Runs {\n        results {\n          id\n          ...RunTimelineFragment\n        }\n      }\n    }\n  }\n\n  ","\n"]);return tb=function(){return e},e}function tk(){let e=(0,ti._)(["\n  query FutureTicksQuery($tickCursor: Float, $ticksUntil: Float) {\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          name\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                pipelines {\n                  id\n                  name\n                  isJob\n                }\n                schedules {\n                  id\n                  name\n                  pipelineName\n                  scheduleState {\n                    id\n                    status\n                  }\n                  ...ScheduleFutureTicksFragment\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return tk=function(){return e},e}let tC=e=>{let{rangeMs:t,filter:n,batchLimit:r=500,refreshInterval:s=2*b.dT,showTicks:i=!0}=e,o=(0,l.useMemo)(()=>null!=n?n:{},[n]),[a,c]=t,d=(0,l.useMemo)(()=>Math.min(Date.now(),c),[c]),u=a/1e3,h=d/1e3,x=(0,l.useMemo)(()=>(function(e,t){let n=[],r=3600*Math.floor(e/3600);e!==r&&n.push([e,Math.min(r+3600,t)]);let s=r+(e===r?0:3600);for(;s+3600<=t;){let e=s+3600;n.push([s,e]),s=e}return s<t&&n.push([s,t]),n})(u,h),[u,h]),p=(0,tp.xJ)(),{localCacheIdPrefix:m}=(0,l.useContext)(tm.I),g=(0,l.useMemo)(()=>new ta(n?{id:!!m&&"".concat(m,"-useRunsForTimeline-filtered"),keyPrefix:JSON.stringify(n),keyMaxCount:3,version:tx}:{id:!!m&&"".concat(m,"-useRunsForTimeline"),version:tx}),[n,m]),[f,j]=(0,l.useState)([]);(0,l.useLayoutEffect)(()=>g.subscribe(u,e=>{j(e.filter(e=>e.startTime<=h&&e.updateTime>=h||e.updateTime>=u&&e.updateTime<=h))}),[g,d,h,u]);let[v,y]=(0,l.useState)({data:void 0,loading:!0,error:void 0,called:!1}),[w,k]=(0,l.useState)({data:void 0,loading:!0,error:void 0,called:!1}),{data:C}=w,[E,T]=(0,l.useState)(!1);(0,tv.j$)("IndexedDBCache",E);let I=(0,l.useCallback)(async()=>{await g.loadCacheFromIndexedDB(),T(!0);let e=new WeakMap;return await (0,td.N)({buckets:x.filter(e=>!g.isCompleteRange(e[0],e[1])).map(e=>{let t=e[0],n=e[1],r=g.getMissingIntervals(t);return r[0]&&(t=Math.max(r[0][0],t),n=Math.min(r[0][1],n)),[t,n]}),setQueryData:y,async fetchData(t,n){var s;let i=t[1],l=t[0];if(g.isCompleteRange(l,i)&&!n)return{data:[],cursor:void 0,hasMore:!1,error:void 0};let{data:a}=await p.query({query:tI,notifyOnNetworkStatusChange:!0,fetchPolicy:"no-cache",variables:{completedFilter:{...o,statuses:Array.from(ek.cv),updatedBefore:i,updatedAfter:l},cursor:n,limit:r}});if("Runs"!==a.completed.__typename)return{data:[],cursor:void 0,hasMore:!1,error:a.completed};let c=a.completed.results,d=c.length===r,u=d?c[c.length-1].id:void 0,h=null!==(s=e.get(t))&&void 0!==s?s:[];return e.set(t,h),d?h.push({updatedAfter:l,updatedBefore:i,runs:c}):(g.addData(l,i,c),h.forEach(e=>{let{updatedAfter:t,updatedBefore:n,runs:r}=e;g.addData(t,n,r)})),{data:[],cursor:u,hasMore:d,error:void 0}}})},[r,x,p,g,o]),M=(0,l.useRef)(0),P=(0,l.useRef)(0),A=(0,l.useRef)(0),O=(0,l.useCallback)(async()=>{let e=++P.current;k(e=>{let{data:t}=e;return{data:t,loading:!0,called:!0,error:void 0}});try{let t=await (0,td.B)({async fetchData(e){let{data:t}=await p.query({query:tT,notifyOnNetworkStatusChange:!0,fetchPolicy:"no-cache",variables:{inProgressFilter:{...o,statuses:[tg.VOA.CANCELING,tg.VOA.STARTED]},cursor:e,limit:r}});if("Runs"!==t.ongoing.__typename)return{data:[],cursor:void 0,hasMore:!1,error:t.ongoing};let n=t.ongoing.results,s=n.length===r,i=s?n[n.length-1].id:void 0;return{data:n,cursor:i,hasMore:s,error:void 0}}});P.current===e&&k({data:t,loading:!1,called:!0,error:void 0})}catch(t){P.current===e&&k(e=>{let{data:n}=e;return{data:n,loading:!1,called:!0,error:t}})}},[p,o,r]),[N,D]=(0,l.useState)({data:void 0,called:!0,loading:!0,error:void 0}),F=(0,l.useCallback)(async()=>{let e=++A.current,t=await p.query({query:tM,variables:i?{tickCursor:u,ticksUntil:c/1e3}:{tickCursor:u,ticksUntil:u},fetchPolicy:"no-cache"});e===A.current&&D({...t,called:!0})},[u,c,p,i]);(0,tv.j$)("CompletedRunTimelineQuery",!v.loading);let{data:B}=N,{workspaceOrError:z}=B||{workspaceOrError:void 0},[R,$]=(0,l.useState)(!0),U=(0,l.useRef)({jobInfo:{},runsByJobKey:{}}),{runsByJobKey:q,jobInfo:K}=(0,l.useMemo)(()=>{if(R)return U.current;let e={},t={},n=Date.now();function r(r){if(null===r.startTime||r.endTime&&1e3*r.endTime<a||!r.repositoryOrigin)return;let s=(0,L.kQ)(r.repositoryOrigin.repositoryName,r.repositoryOrigin.repositoryLocationName),i=tE(s,r.pipelineName);if(t[i]=t[i]||{},t[i][r.id]={id:r.id,status:r.status,startTime:1e3*r.startTime,endTime:r.endTime?1e3*r.endTime:n,automation:th(s,r)},!e[i]){let t=r.pipelineName,n=(0,S.pv)(t);e[i]={repoAddress:s,isAdHoc:n,pipelineName:t}}}f.forEach(r),null==C||C.forEach(r);let s={jobInfo:e,runsByJobKey:t};return U.current=s,s},[R,C,f,a]),H=(0,l.useMemo)(()=>{let e={};return Object.keys(q).length&&Object.entries(q).forEach(t=>{let[n,r]=t,s=Object.values(r),i=K[n];if(!i)return;let{pipelineName:o,isAdHoc:l,repoAddress:a}=i;e[n]={key:n,name:l?"Ad hoc materializations":o,type:l?"asset":"job",repoAddress:a,path:l?null:(0,_.jT)({repoName:a.name,repoLocation:a.location,pipelineName:o,isJob:!0}),runs:s}}),e},[K,q]),V=(0,l.useMemo)(()=>Object.values(H),[H]),J=(0,l.useMemo)(()=>{if(!z||"PythonError"===z.__typename||c<Date.now())return V;let e=new Set,t=[];for(let r of z.locationEntries){var n;if(!r.locationOrLoadError||(null===(n=r.locationOrLoadError)||void 0===n?void 0:n.__typename)==="PythonError")continue;let s=Date.now();for(let n of r.locationOrLoadError.repositories){let i=(0,L.kQ)(n.name,r.locationOrLoadError.name);for(let r of n.pipelines){let o=(n.schedules||[]).filter(e=>e.pipelineName===r.name),l=[];for(let e of o)e.scheduleState.status===tg.ynu.RUNNING&&e.futureTicks.results.forEach(t=>{let{timestamp:n}=t,r=1e3*n;r>s&&eS({start:a,end:c},{start:r,end:r})&&l.push({id:"".concat(e.pipelineName,"-future-run-").concat(n),status:"SCHEDULED",startTime:r,endTime:r+5e3,automation:{type:"schedule",repoAddress:i,name:e.name}})});let d=(0,S.pv)(r.name),u=tE(i,r.name);if(d){if(e.has(u))continue;e.add(u)}let h=d?"Ad hoc materializations":r.name,x=Object.values(q[u]||{});if(!l.length&&!x.length)continue;let p=[...x,...l],m=H[u];m=m?{...m,runs:p}:{key:u,name:h,type:d?"asset":"job",repoAddress:i,path:(0,_.jT)({repoName:i.name,repoLocation:i.location,pipelineName:r.name,isJob:r.isJob}),runs:p},t.push(m)}}}return t},[z,V,q,H]),Q=(0,l.useMemo)(()=>{let e=J.reduce((e,t)=>{let n=t.runs.map(e=>e.startTime);return e[t.key]=Math.min(...n),e},{});return J.sort((t,n)=>e[t.key]-e[n.key])},[J]),W=(0,l.useRef)({ongoing:0,future:0}),Y=(0,l.useRef)([0,0]);return Math.abs(Y.current[0]-t[0])>3e4&&(W.current.future=0),Y.current=t,{jobs:Q,loading:R,refreshState:(0,b.bT)({refresh:(0,l.useCallback)(async()=>{let e=++M.current;$(!0),await Promise.all([(async()=>{W.current.ongoing<Date.now()-3e4&&(await O(),W.current.ongoing=Date.now())})(),(async()=>{c>Date.now()&&W.current.future<Date.now()-6e4&&F()})(),I()]),e===M.current&&$(!1)},[I,F,O,c]),intervalMs:s,leading:!0})}},tE=(e,t)=>"".concat((0,S.pv)(t)?"__adhoc__":t,"-").concat((0,ed.Uz)(e)),tS=(0,tp.Ps)(ty(),tc.$X),tT=(0,tp.Ps)(tw(),tS),tI=(0,tp.Ps)(tb(),tS),tM=(0,tp.Ps)(tk(),tj);var tP=n(8355);let tA=e=>{switch(e){case"1":return 36e5;case"6":return 216e5;case"12":return 432e5;case"24":return 864e5}};function tO(e){let{maxNowMs:t,hourWindowStorageKey:n,hourWindowDefault:r="12",lookaheadHours:s=1}=e,[i,o]=ts(r,n),[a,c]=l.useState(()=>t||Date.now()),[d,u]=l.useState(()=>0),h=l.useMemo(()=>[a-36e5*Number(i)+d,a+36e5*s+d],[i,a,s,d]);l.useEffect(()=>{let e=setInterval(()=>{c(t?Math.min(t,Date.now()):Date.now())},3e4);return()=>{clearInterval(e)}},[i,t]);let x=l.useCallback(()=>{u(e=>e-tA(i))},[i]),p=l.useCallback(()=>{u(e=>e+tA(i))},[i]);return{rangeMs:h,hourWindow:i,setHourWindow:o,onPageEarlier:x,onPageLater:p,onPageNow:l.useCallback(()=>{u(0)},[])}}let tN=e=>{let{Header:t}=e;(0,k.Px)(),(0,A.j)("Overview | Timeline");let{allRepos:n,visibleRepos:s}=l.useContext(tP.C5),{rangeMs:a,hourWindow:d,setHourWindow:u,onPageEarlier:h,onPageLater:x,onPageNow:p}=tO({}),[m,g]=(0,O.q)({queryKey:"search",defaults:{search:""}}),[f,j]=eg(),v=tC({rangeMs:a}),{jobs:y,loading:w,refreshState:b}=(0,l.useDeferredValue)(v),C=(0,l.useMemo)(()=>"automation"===f?eu(y):y,[f,y]),E=(0,l.useMemo)(()=>new Set(s.map(e=>{let t=(0,L.kQ)(e.repository.name,e.repositoryLocation.name);return(0,ed.Uz)(t)})),[s]),S=l.useMemo(()=>{let e=m.toLocaleLowerCase().trim();return new Set(C.filter(e=>{let{repoAddress:t}=e;return E.has((0,ed.Uz)(t))}).map(e=>{let{key:t}=e;return t}).filter(t=>t.toLocaleLowerCase().includes(e)))},[m,C,E]),T=l.useMemo(()=>C.filter(e=>{let{key:t}=e;return S.has(t)}),[C,S]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t,{refreshState:b}),(0,r.jsxs)(o.x,{padding:{horizontal:24,vertical:12},flex:{alignItems:"center",justifyContent:"space-between",gap:16},children:[(0,r.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[n.length>1&&(0,r.jsx)(ef.C,{}),(0,r.jsx)(c.oi,{icon:"search",value:m,onChange:e=>g(e.target.value),placeholder:"Filter by name…",style:{width:"200px"}})]}),(0,r.jsxs)(o.x,{flex:{direction:"row",gap:16,alignItems:"center"},children:[(0,r.jsxs)(o.x,{flex:{direction:"row",gap:8,alignItems:"center"},children:[(0,r.jsx)("div",{style:{whiteSpace:"nowrap"},children:"Group by"}),(0,r.jsx)(el,{value:f,onSelect:j})]}),(0,r.jsx)(es.h,{activeItems:new Set([d]),buttons:[{id:"1",label:"1hr"},{id:"6",label:"6hr"},{id:"12",label:"12hr"},{id:"24",label:"24hr"}],onClick:e=>u(e)}),(0,r.jsxs)(o.x,{flex:{direction:"row",gap:4,alignItems:"center"},children:[(0,r.jsx)(i.zx,{onClick:h,children:"←"}),(0,r.jsx)(i.zx,{onClick:p,children:"Now"}),(0,r.jsx)(i.zx,{onClick:x,children:"→"})]})]})]}),(0,r.jsx)(ei.S,{region:"timeline",children:(0,r.jsx)(e$,{loading:w,rangeMs:a,rows:T})})]})};var tD=n(17872),tL=n(38267);let t_=()=>{(0,A.j)("Overview | Activity");let e=l.useCallback(e=>{let{refreshState:t}=e;return(0,r.jsx)(er,{tab:"activity",refreshState:t})},[]),[t,n]=(0,tr.U)("overview-activity-tab",e=>["timeline","assets"].includes(e)?e:"timeline"),{enableAssetHealthOverviewPreview:a}=l.useContext(Z.G),c=a?"timeline":t,d=l.useCallback(e=>{let{selected:t}=e;return a?null:(c!==t&&n(t),(0,r.jsxs)(i.zH,{children:[(0,r.jsx)(tL.Q1,{$active:"timeline"===t,to:"/overview/activity/timeline",children:"Timeline"}),(0,r.jsx)(tL.Q1,{$active:"assets"===t,to:"/overview/activity/assets",children:"Assets"})]}))},[c,n,a]);return(0,r.jsx)(o.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:(0,r.jsxs)(s.rs,{children:[!a&&(0,r.jsx)(tD.A,{path:"/overview/activity/assets",children:(0,r.jsx)(F,{Header:e,TabButton:d})}),(0,r.jsx)(tD.A,{path:"/overview/activity/timeline",children:(0,r.jsx)(tN,{Header:e,TabButton:d})}),(0,r.jsx)(tD.A,{path:"*",isNestingRoute:!0,render:l.useCallback(()=>"timeline"===c?(0,r.jsx)(s.l_,{to:"/overview/activity/timeline"}):(0,r.jsx)(s.l_,{to:"/overview/activity/assets"}),[c])})]})})};var tF=n(63065);let tB=()=>((0,k.Px)(),(0,A.j)("Overview | Jobs"),(0,r.jsxs)(o.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,r.jsx)(Q.m,{title:(0,r.jsx)(f.X6,{children:"Overview"}),tabs:(0,r.jsx)(en,{tab:"jobs"})}),(0,r.jsx)(tF.e,{})]}));var tz=n(37483),tR=n(3922);let t$=e=>{let{repos:t}=e,n=(0,l.useRef)(null),s=(0,l.useMemo)(()=>t.map(e=>{let{repoAddress:t}=e;return(0,ed.Uz)(t)}),[t]),{expandedKeys:i,onToggle:o,onToggleAll:a}=(0,e_.N)(eA.y,s),c=(0,l.useMemo)(()=>{let e=[];return t.forEach(t=>{let{repoAddress:n,resources:r}=t;e.push({type:"header",repoAddress:n,resourceCount:r.length});let s=(0,ed.Uz)(n);i.includes(s)&&r.forEach(t=>{e.push({type:"resource",repoAddress:n,...t})})}),e},[t,i]),d=(0,eD.w)(t.map(e=>{let{repoAddress:t}=e;return t.name})),u=(0,j.MG)({count:c.length,getScrollElement:()=>n.current,estimateSize:e=>{let t=c[e];return(null==t?void 0:t.type)==="header"?32:64},overscan:10}),h=u.getTotalSize(),p=u.getVirtualItems();return(0,r.jsx)("div",{style:{overflow:"hidden"},children:(0,r.jsxs)(D.W2,{ref:n,children:[(0,r.jsx)(tR.f,{}),(0,r.jsx)(D.Nh,{$totalHeight:h,children:p.map(e=>{let{index:t,key:n,size:s,start:l}=e,u=c[t];return"header"===u.type?(0,r.jsx)(eB.vG,{repoAddress:u.repoAddress,height:s,start:l,onToggle:o,onToggleAll:a,expanded:i.includes((0,ed.Uz)(u.repoAddress)),showLocation:d.has(u.repoAddress.name),rightElement:(0,r.jsx)(ej.u,{content:1===u.resourceCount?"1 resource":"".concat(u.resourceCount," resources"),placement:"top",children:(0,r.jsx)(x.V,{children:u.resourceCount})})},n):(0,r.jsx)(tR.K,{height:s,start:l,...u},n)})})]})})};var tU=n(907),tq=n(49455),tK=n(78491),tH=n(71662),tV=n(73658);function tJ(){let e=(0,ti._)(["\n  query OverviewResourcesQuery {\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                allTopLevelResourceDetails {\n                  id\n                  ...ResourceEntryFragment\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"]);return tJ=function(){return e},e}let tQ=()=>{(0,k.Px)(),(0,A.j)("Overview | Resources");let{allRepos:e,visibleRepos:t,loading:n,data:s}=(0,l.useContext)(tP.C5),[i,d]=(0,O.q)({queryKey:"search",defaults:{search:""}}),u=e.length,h=(0,tp.aM)(tY,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),{data:x,loading:m}=h,g=(0,b.C4)(h,b.dT),f=(0,l.useMemo)(()=>{let e=(0,tq.S)(t),n=Object.values(s).filter(e=>"WorkspaceLocationEntry"===e.__typename),r=null==x?void 0:x.workspaceOrError;return tW((null==r?void 0:r.__typename)==="Workspace"?r.locationEntries:n).filter(t=>{let{repoAddress:n}=t;return e.has((0,ed.Uz)(n))})},[s,x,t]),j=!x&&m&&n,v=i.trim().toLocaleLowerCase(),y=v.length>0,w=(0,l.useMemo)(()=>{let e=v.toLocaleLowerCase();return f.map(t=>{let{repoAddress:n,resources:r}=t;return{repoAddress:n,resources:r.filter(t=>{let{name:n}=t;return n.toLocaleLowerCase().includes(e)})}}).filter(e=>{let{resources:t}=e;return t.length>0})},[f,v]),C=m&&!x;return(0,r.jsxs)(o.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,r.jsx)(er,{tab:"resources",refreshState:g}),(0,r.jsxs)(o.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[u>1?(0,r.jsx)(ef.C,{}):null,(0,r.jsx)(c.oi,{icon:"search",value:i,rightElement:C?(0,r.jsx)(tV.W,{tooltipContent:"Loading resources…"}):void 0,onChange:e=>d(e.target.value),placeholder:"Filter by resource name…",style:{width:"340px"}})]}),j&&!u?(0,r.jsx)(o.x,{padding:64,children:(0,r.jsx)(a.$,{purpose:"page"})}):(()=>{if(j)return(0,r.jsx)(o.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,r.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,r.jsx)(a.$,{purpose:"body-text"}),(0,r.jsx)("div",{style:{color:p.$()},children:"Loading resources…"})]})});let n=e.length>t.length;return w.length?(0,r.jsx)(t$,{repos:w}):y?(0,r.jsx)(o.x,{padding:{top:20},children:(0,r.jsx)(tz.t,{icon:"search",title:"No matching resources",description:n?(0,r.jsxs)("div",{children:["No resources matching ",(0,r.jsx)("strong",{children:i})," were found in the selected code locations"]}):(0,r.jsxs)("div",{children:["No resources matching ",(0,r.jsx)("strong",{children:i})," were found in your definitions"]})})}):(0,r.jsx)(o.x,{padding:{top:20},children:(0,r.jsx)(tz.t,{icon:"search",title:"No resources",description:n?"No resources were found in the selected code locations":"No resources were found in your definitions"})})})()]})},tW=e=>{let t=e.map(e=>e.locationOrLoadError),n=[];for(let e of t)if((null==e?void 0:e.__typename)==="RepositoryLocation")for(let t of e.repositories){let{name:r,allTopLevelResourceDetails:s}=t,i=(0,L.kQ)(r,e.name);s.length>0&&n.push({repoAddress:i,resources:s})}return(0,tU.S)(n)},tY=(0,tp.Ps)(tJ(),tK.B,tH.L);var tG=n(17702),tZ=n(87209),tX=n(27028);let t0=e=>{let{repos:t,headerCheckbox:n,checkedKeys:s,onToggleCheckFactory:i}=e,o=l.useRef(null),a=l.useMemo(()=>t.map(e=>{let{repoAddress:t}=e;return(0,ed.Uz)(t)}),[t]),{expandedKeys:c,onToggle:d,onToggleAll:u}=(0,e_.N)(eA.y,a),h=l.useMemo(()=>{let e=[];return t.forEach(t=>{let{repoAddress:n,schedules:r}=t;e.push({type:"header",repoAddress:n,scheduleCount:r.length});let s=(0,ed.Uz)(n);c.includes(s)&&r.forEach(t=>{e.push({type:"schedule",repoAddress:n,schedule:t})})}),e},[t,c]),p=(0,eD.w)(t.map(e=>{let{repoAddress:t}=e;return t.name})),m=(0,j.MG)({count:h.length,getScrollElement:()=>o.current,estimateSize:e=>{let t=h[e];return(null==t?void 0:t.type)==="header"?32:64},overscan:10}),g=m.getTotalSize(),f=m.getVirtualItems();return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{style:{overflow:"hidden"},children:(0,r.jsxs)(D.W2,{ref:o,children:[(0,r.jsx)(tX.og,{checkbox:n}),(0,r.jsx)(D.Nh,{$totalHeight:g,children:f.map(e=>{let{index:t,key:o,size:l,start:a}=e,m=h[t];if("header"===m.type)return(0,r.jsx)(eB.vG,{repoAddress:m.repoAddress,height:l,start:a,onToggle:d,onToggleAll:u,expanded:c.includes((0,ed.Uz)(m.repoAddress)),showLocation:p.has(m.repoAddress.name),rightElement:(0,r.jsx)(ej.u,{content:1===m.scheduleCount?"1 schedule":"".concat(m.scheduleCount," schedules"),placement:"top",children:(0,r.jsx)(x.V,{children:m.scheduleCount})})},o);let g=(0,tZ.g)(m.repoAddress,m.schedule.name);return(0,r.jsx)(tX.iT,{name:m.schedule.name,scheduleState:m.schedule.scheduleState,showCheckboxColumn:!!n,checked:s.has(g),onToggleChecked:i(g),repoAddress:m.repoAddress,height:l,start:a},o)})})]})})})};var t1=n(52154),t2=n(40782),t3=n(77044),t4=n(70468),t6=n(74050),t8=n(74302),t5=n(2389),t9=n(50027),t7=n(2949);function ne(){let e=(0,ti._)(["\n  query OverviewSchedulesQuery {\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                schedules {\n                  id\n                  name\n                  description\n                  scheduleState {\n                    id\n                    ...BasicInstigationStateFragment\n                  }\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n    instance {\n      id\n      ...InstanceHealthFragment\n    }\n  }\n\n  ","\n  ","\n  ","\n"]);return ne=function(){return e},e}let nt=()=>{let{allRepos:e,visibleRepos:t,loading:n,data:s}=(0,l.useContext)(tP.C5),i=e.length,[d,u]=(0,O.q)({queryKey:"search",defaults:{search:""}}),h=(0,t9.A)(),x=(0,t7.g)(),m=(0,l.useMemo)(()=>[h,x],[h,x]),{button:g,activeFiltersJsx:f}=(0,t8.m)({filters:m}),j=(0,tp.aM)(nr,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),{data:v,loading:y}=j,w=(0,b.C4)(j,b.dT),k=(0,l.useMemo)(()=>{let e=(0,tq.S)(t),n=Object.values(s).filter(e=>"WorkspaceLocationEntry"===e.__typename),r=null==v?void 0:v.workspaceOrError;return nn((null==r?void 0:r.__typename)==="Workspace"?r.locationEntries:n).filter(t=>{let{repoAddress:n}=t;return e.has((0,ed.Uz)(n))})},[v,s,t]),{state:C}=x,E=(0,l.useMemo)(()=>k.map(e=>{let{schedules:t,...n}=e;return{...n,schedules:C.size?t.filter(e=>{let{scheduleState:t}=e;return C.has(t.status)}):t}}),[k,C]),S=d.trim().toLocaleLowerCase(),T=S.length>0,I=(0,l.useMemo)(()=>{let e=S.toLocaleLowerCase();return E.map(t=>{let{repoAddress:n,schedules:r}=t;return{repoAddress:n,schedules:r.filter(t=>{let{name:n}=t;return n.toLocaleLowerCase().includes(e)})}}).filter(e=>{let{schedules:t}=e;return t.length>0})},[E,S]),M=(0,l.useMemo)(()=>I.some(e=>{let{schedules:t}=e;return t.length>0}),[I]),P=(0,l.useMemo)(()=>k.map(e=>{let{repoAddress:t,schedules:n}=e;return n.filter(e=>{let{scheduleState:t}=e;return(0,t3.i)(t)}).map(e=>{let{name:n,scheduleState:r}=e;return{repoAddress:t,scheduleName:n,scheduleState:r}})}).flat(),[k]),A=(0,l.useMemo)(()=>P.map(e=>{let{repoAddress:t,scheduleName:n}=e;return(0,tZ.g)(t,n)}),[P]),[{checkedIds:N},{onToggleFactory:D,onToggleAll:L}]=(0,t1.a)(A),_=(0,l.useMemo)(()=>{let e=new Set(I.map(e=>{let{repoAddress:t,schedules:n}=e;return n.map(e=>{let{name:n}=e;return(0,tZ.g)(t,n)})}).flat());return A.filter(t=>e.has(t))},[A,I]),F=(0,l.useMemo)(()=>{let e=new Set(_.filter(e=>N.has(e)));return P.filter(t=>{let{repoAddress:n,scheduleName:r}=t;return e.has((0,tZ.g)(n,r))})},[_,P,N]),B=A.length>0,z=F.length,R=n&&!i&&y&&!v,$=y&&!v;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(o.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,r.jsxs)(o.x,{flex:{direction:"row",gap:12},children:[g,(0,r.jsx)(c.oi,{icon:"search",value:d,rightElement:$?(0,r.jsx)(tV.W,{tooltipContent:"Loading schedules…"}):void 0,onChange:e=>{u(e.target.value),L(!1)},placeholder:"Filter by schedule name…",style:{width:"340px"}})]}),(0,r.jsx)(ej.u,{content:"You do not have permission to start or stop these schedules",canShow:M&&!B,placement:"top-end",useDisabledButtonTooltipFix:!0,children:(0,r.jsx)(t4._,{schedules:F,onDone:()=>w.refetch()})})]}),f.length?(0,r.jsx)(o.x,{padding:{vertical:8,horizontal:24},border:"top-and-bottom",flex:{direction:"row",gap:8},children:f}):null,R&&!i?(0,r.jsx)(o.x,{padding:64,children:(0,r.jsx)(a.$,{purpose:"page"})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t6.K,{daemonHealth:null==v?void 0:v.instance.daemonHealth,padding:{vertical:16,horizontal:24},border:"top"}),(()=>{if(R)return(0,r.jsx)(o.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,r.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,r.jsx)(a.$,{purpose:"body-text"}),(0,r.jsx)("div",{style:{color:p.$()},children:"Loading schedules…"})]})});let n=e.length>t.length;return I.length?(0,r.jsx)(t0,{headerCheckbox:B?(0,r.jsx)(t5.W,{checkedCount:z,totalCount:_.length,onToggleAll:L}):void 0,repos:I,checkedKeys:N,onToggleCheckFactory:D}):T?(0,r.jsx)(o.x,{padding:{top:20},children:(0,r.jsx)(tz.t,{icon:"search",title:"No matching schedules",description:n?(0,r.jsxs)("div",{children:["No schedules matching ",(0,r.jsx)("strong",{children:d})," were found in the selected code locations"]}):(0,r.jsxs)("div",{children:["No schedules matching ",(0,r.jsx)("strong",{children:d})," were found in your definitions"]})})}):(0,r.jsx)(o.x,{padding:{top:20},children:(0,r.jsx)(tz.t,{icon:"search",title:"No schedules",description:n?"No matching schedules were found in the selected code locations":"No matching schedules were found in your definitions"})})})()]})]})},nn=e=>{let t=e.map(e=>e.locationOrLoadError),n=[];for(let e of t)if((null==e?void 0:e.__typename)==="RepositoryLocation")for(let t of e.repositories){let{name:r,schedules:s}=t,i=(0,L.kQ)(r,e.name),o=s.map(e=>{let{name:t,scheduleState:n}=e;return{name:t,scheduleState:n}});o.length>0&&n.push({repoAddress:i,schedules:o})}return(0,tU.S)(n)},nr=(0,tp.Ps)(ne(),tG.i,tK.B,t2.O),ns=()=>((0,k.Px)(),(0,A.j)("Overview | Schedules"),(0,r.jsxs)(o.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,r.jsx)(er,{tab:"schedules"}),(0,r.jsx)(nt,{})]}));var ni=n(40389),no=n(53029);let nl=e=>{let{repos:t,headerCheckbox:n,checkedKeys:s,onToggleCheckFactory:i}=e,o=l.useRef(null),a=l.useMemo(()=>t.map(e=>{let{repoAddress:t}=e;return(0,ed.Uz)(t)}),[t]),{expandedKeys:c,onToggle:d,onToggleAll:u}=(0,e_.N)(eA.y,a),h=l.useMemo(()=>{let e=[];return t.forEach(t=>{let{repoAddress:n,sensors:r}=t;e.push({type:"header",repoAddress:n,sensorCount:r.length});let s=(0,ed.Uz)(n);c.includes(s)&&r.forEach(t=>{e.push({type:"sensor",repoAddress:n,sensor:t})})}),e},[t,c]),p=(0,eD.w)(t.map(e=>{let{repoAddress:t}=e;return t.name})),m=(0,j.MG)({count:h.length,getScrollElement:()=>o.current,estimateSize:e=>{let t=h[e];return(null==t?void 0:t.type)==="header"?32:64},overscan:10}),g=m.getTotalSize(),f=m.getVirtualItems();return(0,r.jsx)("div",{style:{overflow:"hidden"},children:(0,r.jsxs)(D.W2,{ref:o,children:[(0,r.jsx)(no.KF,{checkbox:n}),(0,r.jsx)(D.Nh,{$totalHeight:g,children:f.map(e=>{let{index:t,key:o,size:l,start:a}=e,m=h[t];if("header"===m.type)return(0,r.jsx)(eB.vG,{repoAddress:m.repoAddress,height:l,start:a,onToggle:d,onToggleAll:u,expanded:c.includes((0,ed.Uz)(m.repoAddress)),showLocation:p.has(m.repoAddress.name),rightElement:(0,r.jsx)(ej.u,{content:1===m.sensorCount?"1 sensor":"".concat(m.sensorCount," sensors"),placement:"top",children:(0,r.jsx)(x.V,{children:m.sensorCount})})},o);let g=(0,ni.x)(m.repoAddress,m.sensor.name);return(0,r.jsx)(no.Rx,{name:m.sensor.name,sensorState:m.sensor.sensorState,showCheckboxColumn:!!n,checked:s.has(g),onToggleChecked:i(g),repoAddress:m.repoAddress,height:l,start:a},o)})})]})})};var na=n(64265),nc=n(5409),nd=n(81602);function nu(){let e=(0,ti._)(["\n  query OverviewSensorsQuery {\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                sensors {\n                  id\n                  name\n                  description\n                  sensorType\n                  sensorState {\n                    id\n                    ...BasicInstigationStateFragment\n                  }\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n    instance {\n      id\n      ...InstanceHealthFragment\n    }\n  }\n\n  ","\n  ","\n  ","\n"]);return nu=function(){return e},e}function nh(e){let t=no.W_[e].name;return{label:t,value:{type:e,label:t},match:[t]}}let nx={[tg.dEY.ASSET]:nh(tg.dEY.ASSET),[tg.dEY.AUTO_MATERIALIZE]:nh(tg.dEY.AUTO_MATERIALIZE),[tg.dEY.AUTOMATION]:nh(tg.dEY.AUTOMATION),[tg.dEY.FRESHNESS_POLICY]:nh(tg.dEY.FRESHNESS_POLICY),[tg.dEY.MULTI_ASSET]:nh(tg.dEY.MULTI_ASSET),[tg.dEY.RUN_STATUS]:nh(tg.dEY.RUN_STATUS),[tg.dEY.STANDARD]:nh(tg.dEY.STANDARD)},np=Object.values(nx),nm=()=>{let{allRepos:e,visibleRepos:t,loading:n,data:s}=(0,l.useContext)(tP.C5),[i,d]=(0,O.q)({queryKey:"search",defaults:{search:""}}),[u,h]=(0,O.q)({encode:e=>({sensorType:e.size?Array.from(e).join(","):void 0}),decode:e=>{var t;return new Set((null===(t=e.sensorType)||void 0===t?void 0:t.split(","))||[])}}),x=(0,t9.A)(),m=(0,t7.g)(),g=(0,nd.im)({name:"Sensor type",allValues:np,icon:"sensors",getStringValue:e=>e.label,state:(0,l.useMemo)(()=>new Set(Array.from(u).map(e=>nx[e].value)),[u]),renderLabel:e=>{let{value:t}=e;return(0,r.jsx)("span",{children:t.label})},onStateChanged:e=>{h(new Set(Array.from(e).map(e=>e.type)))}}),f=(0,l.useMemo)(()=>[x,m,g],[x,m,g]),{button:j,activeFiltersJsx:v}=(0,t8.m)({filters:f}),y=(0,tp.aM)(nf,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),{data:w,loading:k}=y,C=(0,b.C4)(y,b.dT),E=(0,l.useMemo)(()=>{let e=Object.values(s).filter(e=>"WorkspaceLocationEntry"===e.__typename),n=null==w?void 0:w.workspaceOrError,r=(null==n?void 0:n.__typename)==="Workspace"?n.locationEntries:e,i=(0,tq.S)(t);return ng(r).filter(e=>{let{repoAddress:t}=e;return i.has((0,ed.Uz)(t))})},[w,s,t]),{state:S}=m,T=(0,l.useMemo)(()=>E.map(e=>{let{sensors:t,...n}=e;return{...n,sensors:t.filter(e=>{let{sensorState:t,sensorType:n}=e;return(!S.size||!!S.has(t.status))&&(!u.size||!!u.has(n))})}}),[E,S,u]),I=i.trim().toLocaleLowerCase(),M=I.length>0,P=(0,l.useMemo)(()=>{let e=I.toLocaleLowerCase();return T.map(t=>{let{repoAddress:n,sensors:r}=t;return{repoAddress:n,sensors:r.filter(t=>{let{name:n}=t;return n.toLocaleLowerCase().includes(e)})}}).filter(e=>{let{sensors:t}=e;return t.length>0})},[T,I]),A=(0,l.useMemo)(()=>P.some(e=>{let{sensors:t}=e;return t.length>0}),[P]),N=(0,l.useMemo)(()=>E.map(e=>{let{repoAddress:t,sensors:n}=e;return n.filter(e=>{let{sensorState:t}=e;return(0,t3.i)(t)}).map(e=>{let{name:n,sensorState:r}=e;return{repoAddress:t,sensorName:n,sensorState:r}})}).flat(),[E]),D=(0,l.useMemo)(()=>N.map(e=>{let{repoAddress:t,sensorName:n}=e;return(0,ni.x)(t,n)}),[N]),[{checkedIds:L},{onToggleFactory:_,onToggleAll:F}]=(0,t1.a)(D),B=(0,l.useMemo)(()=>{let e=new Set(P.map(e=>{let{repoAddress:t,sensors:n}=e;return n.map(e=>{let{name:n}=e;return(0,ni.x)(t,n)})}).flat());return D.filter(t=>e.has(t))},[D,P]),z=(0,l.useMemo)(()=>{let e=new Set(B.filter(e=>L.has(e)));return N.filter(t=>{let{repoAddress:n,sensorName:r}=t;return e.has((0,ni.x)(n,r))})},[B,N,L]),R=D.length>0,$=z.length,U=n&&k&&!w,q=k&&!w;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(o.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",justifyContent:"space-between",gap:12,grow:0},children:[(0,r.jsxs)(o.x,{flex:{direction:"row",gap:12},children:[j,(0,r.jsx)(c.oi,{icon:"search",value:i,rightElement:q?(0,r.jsx)(tV.W,{tooltipContent:"Loading sensors…"}):void 0,onChange:e=>d(e.target.value),placeholder:"Filter by sensor name…",style:{width:"340px"}})]}),(0,r.jsxs)(o.x,{flex:{direction:"row",gap:12,alignItems:"center"},children:[(0,r.jsx)(b.xi,{refreshState:C}),(0,r.jsx)(ej.u,{content:"You do not have permission to start or stop these schedules",canShow:A&&!R,placement:"top-end",useDisabledButtonTooltipFix:!0,children:(0,r.jsx)(na.b,{sensors:z,onDone:()=>C.refetch()})})]})]}),v.length?(0,r.jsx)(o.x,{padding:{vertical:8,horizontal:24},border:"top-and-bottom",flex:{direction:"row",gap:8},children:v}):null,U?(0,r.jsx)(o.x,{padding:64,children:(0,r.jsx)(a.$,{purpose:"page"})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(nc.F,{daemonHealth:null==w?void 0:w.instance.daemonHealth,padding:{vertical:16,horizontal:24},border:"top"}),(()=>{if(U)return(0,r.jsx)(o.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,r.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,r.jsx)(a.$,{purpose:"body-text"}),(0,r.jsx)("div",{style:{color:p.$()},children:"Loading sensors…"})]})});let n=e.length>t.length;return P.length?(0,r.jsx)(nl,{headerCheckbox:R?(0,r.jsx)(t5.W,{checkedCount:$,totalCount:B.length,onToggleAll:F}):void 0,repos:P,checkedKeys:L,onToggleCheckFactory:_}):M?(0,r.jsx)(o.x,{padding:{top:20},children:(0,r.jsx)(tz.t,{icon:"search",title:"No matching sensors",description:n?(0,r.jsxs)("div",{children:["No sensors matching ",(0,r.jsx)("strong",{children:i})," were found in the selected code locations"]}):(0,r.jsxs)("div",{children:["No sensors matching ",(0,r.jsx)("strong",{children:i})," were found in your definitions"]})})}):(0,r.jsx)(o.x,{padding:{top:20},children:(0,r.jsx)(tz.t,{icon:"search",title:"No sensors",description:n?"No sensors were found in the selected code locations":"No sensors were found in your definitions"})})})()]})]})},ng=e=>{let t=e.map(e=>e.locationOrLoadError),n=[];for(let e of t)if((null==e?void 0:e.__typename)==="RepositoryLocation")for(let t of e.repositories){let{name:r,sensors:s}=t,i=(0,L.kQ)(r,e.name);s.length>0&&n.push({repoAddress:i,sensors:s})}return(0,tU.S)(n)},nf=(0,tp.Ps)(nu(),tG.i,tK.B,t2.O),nj=()=>((0,k.Px)(),(0,A.j)("Overview | Sensors"),(0,r.jsxs)(o.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,r.jsx)(er,{tab:"sensors"}),(0,r.jsx)(nm,{})]}));var nv=n(49308),ny=n(1747),nw=n(37504),nb=n(93812),nk=n(76575),nC=n(28363),nE=n(87803),nS=n(4733),nT=n(15332);let nI=e=>{var t,n;let{setSelectedTick:s,setTableView:i,setTimerange:o,setParentStatuses:a}=e,[c,d]=(0,O.q)({queryKey:"statuses",decode:(0,l.useCallback)(e=>{let{statuses:t}=e;return new Set(t?JSON.parse(t):[tg.izS.STARTED,tg.izS.SUCCESS,tg.izS.FAILURE,tg.izS.SKIPPED])},[]),encode:(0,l.useCallback)(e=>({statuses:JSON.stringify(Array.from(e))}),[])}),{queryResult:u,paginationProps:h}=(0,nT.l)({query:nb.X,variables:{statuses:(0,l.useMemo)(()=>Array.from(c),[c])},nextCursorForResult:e=>{var t;let n=e.autoMaterializeTicks;if(n.length)return null===(t=n[14])||void 0===t?void 0:t.id},getResultArray:e=>(null==e?void 0:e.autoMaterializeTicks)?e.autoMaterializeTicks:[],pageSize:15});return(0,b.C4)(u,1e4,!h.hasPrevCursor),(0,l.useEffect)(()=>{if(h.hasPrevCursor){var e,t,n;let r=null===(e=u.data)||void 0===e?void 0:e.autoMaterializeTicks;if(r&&r.length){let e=null===(t=r[r.length-1])||void 0===t?void 0:t.timestamp,s=null===(n=r[0])||void 0===n?void 0:n.endTimestamp;e&&s&&o([e,s])}}else o(void 0)},[h.hasPrevCursor,null===(t=u.data)||void 0===t?void 0:t.autoMaterializeTicks,o]),(0,l.useEffect)(()=>{h.hasPrevCursor?a(Array.from(c)):a(void 0)},[h.hasPrevCursor,a,c]),(0,r.jsx)(nS.V,{loading:u.loading,ticks:(null===(n=u.data)||void 0===n?void 0:n.autoMaterializeTicks)||[],paginationProps:h,setSelectedTick:s,setStatuses:d,setTableView:i,statuses:c})};var nM=n(56130),nP=n(36803),nA=n(59502),nO=n(57758);let nN=()=>{var e;let t=(0,ee.dx)(),n=(0,nM.p)(),{permissions:{canToggleAutoMaterialize:s}={}}=(0,nP.WB)(),[i,c]=(0,l.useState)(!1),[d,u]=(0,l.useState)(void 0),[h,x]=(0,l.useState)(void 0),m=(0,l.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();return h||d?{afterTimestamp:null==h?void 0:h[0],beforeTimestamp:null==h?void 0:h[1],statuses:d}:{afterTimestamp:(e-12e5)/1e3}},[d,h]),[g,j]=(0,tp.td)(nb.X),v=(0,l.useCallback)(async()=>await g({variables:m()}),[g,m]);(0,b.bT)({refresh:v,enabled:!i&&!h&&!d,intervalMs:2e3,leading:!0});let[y,w]=(0,l.useState)(null),[k,C]=(0,O.q)((0,l.useMemo)(()=>({queryKey:"view",decode:e=>{let{view:t}=e;return"runs"===t?"runs":"evaluations"},encode:e=>({view:e,cursor:void 0,statuses:void 0})}),[])),E=null!==(e=j.data)&&void 0!==e?e:j.previousData,S=(0,l.useMemo)(()=>(null==E?void 0:E.autoMaterializeTicks)||[],[E]),T=(0,l.useMemo)(()=>{var e;return null!==(e=null==S?void 0:S.map((e,t)=>{let n=S[t-1];if(n&&(0,nO.g6)(e,t)){let t={...e};return t.endTimestamp=n.timestamp,t.status=tg.izS.FAILURE,t}return e}))&&void 0!==e?e:[]},[JSON.stringify(S.map(e=>"".concat(e.id,":").concat(e.status)))]),I=(0,l.useCallback)(e=>{c(!!e)},[c]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.x,{padding:{vertical:12,horizontal:24},children:(0,r.jsx)(nE.q,{})}),(0,r.jsx)(ny.i,{children:(0,r.jsxs)("tbody",{children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:"Running"}),(0,r.jsx)("td",{children:t.loading?(0,r.jsx)(a.$,{purpose:"body-text"}):(0,r.jsx)(nw.X,{format:"switch",checked:!t.paused,disabled:!s,onChange:async e=>{let r=e.target.checked;r||await n({title:"Pause Auto-materializing?",description:"Pausing Auto-materializing will prevent new materializations triggered by an Auto-materializing policy."}),t.setPaused(!r)}})})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:"Evaluation frequency"}),(0,r.jsx)("td",{children:"~30s"})]})]})}),(0,r.jsx)(o.x,{padding:{vertical:12,horizontal:24},border:"bottom",children:(0,r.jsx)(f.Tj,{children:"Evaluation timeline"})}),E?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(nA.p,{ticks:T,onHoverTick:I,onSelectTick:w,exactRange:h,timeRange:12e5,tickGrid:3e5,timeAfter:18e4}),(0,r.jsx)(nk.d,{tick:y,isOpen:!!y,close:()=>{w(null)}}),"evaluations"===k?(0,r.jsx)(nI,{setSelectedTick:w,setTableView:C,setParentStatuses:u,setTimerange:x}):(0,r.jsx)(nC.o,{setTableView:C})]}):(0,r.jsxs)(o.x,{padding:{vertical:48},flex:{direction:"row",justifyContent:"center",gap:12,alignItems:"center"},children:[(0,r.jsx)(a.$,{purpose:"body-text"}),(0,r.jsx)("div",{style:{color:p.$()},children:"Loading evaluations…"})]})]})},nD=()=>{let e=(0,X.I)(),{flagSettingsPage:t}=(0,G.gV)();switch(e){case"unknown":return(0,r.jsx)("div",{});case"has-global-amp":return(0,r.jsx)(nL,{});case"has-sensor-amp":return(0,r.jsx)(s.l_,{to:t?"/automation":"/overview/sensors"});default:(0,eo.UT)(e)}},nL=()=>((0,k.Px)(),(0,A.j)("Overview | Auto-materialize"),(0,r.jsxs)(nv.T,{children:[(0,r.jsx)(er,{tab:"amp"}),(0,r.jsx)(nN,{})]}));var n_=n(80122),nF=n(90731),nB=n(54048);function nz(){let e=(0,ti._)(["\n  query InstanceBackfillsQuery($status: BulkActionStatus, $cursor: String, $limit: Int) {\n    partitionBackfillsOrError(status: $status, cursor: $cursor, limit: $limit) {\n      ... on PartitionBackfills {\n        results {\n          id\n          status\n          isValidSerialization\n          numPartitions\n          timestamp\n          partitionSetName\n          partitionSet {\n            id\n            name\n            mode\n            pipelineName\n            repositoryOrigin {\n              id\n              repositoryName\n              repositoryLocationName\n            }\n          }\n          error {\n            ...PythonErrorFragment\n          }\n\n          ...BackfillTableFragment\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"]);return nz=function(){return e},e}let nR=e=>{switch(e){case tg.Jv3.CANCELED:return"Canceled";case tg.Jv3.CANCELING:return"Canceling";case tg.Jv3.COMPLETED:return"Completed";case tg.Jv3.FAILED:return"Failed";case tg.Jv3.REQUESTED:return"In progress";case tg.Jv3.COMPLETED_SUCCESS:return"Success";case tg.Jv3.COMPLETED_FAILED:return"Failed"}},n$=Object.keys(tg.Jv3).map(e=>{let t=nR(e);return{label:t,value:e,match:[e,t]}}),nU=()=>{(0,k.Px)(),(0,A.j)("Overview | Backfills");let[e,t]=(0,O.q)({encode:e=>({status:e.size?Array.from(e).join(","):void 0}),decode:e=>{var t;return new Set((null===(t=e.status)||void 0===t?void 0:t.split(","))||[])}}),n=(0,nd.im)({name:"Status",icon:"status",allValues:n$,allowMultipleSelections:!1,closeOnSelect:!0,renderLabel:e=>{let{value:t}=e;return(0,r.jsx)("div",{children:nR(t)})},getStringValue:e=>nR(e),state:e,onStateChanged:t}),{button:s,activeFiltersJsx:i}=(0,t8.m)({filters:[n]}),{queryResult:l,paginationProps:c}=(0,nT.l)({query:nq,variables:{status:e.size>0?Array.from(e)[0]:void 0},pageSize:10,nextCursorForResult:e=>{var t;return"PartitionBackfills"===e.partitionBackfillsOrError.__typename?null===(t=e.partitionBackfillsOrError.results[9])||void 0===t?void 0:t.id:void 0},getResultArray:e=>(null==e?void 0:e.partitionBackfillsOrError.__typename)==="PartitionBackfills"?e.partitionBackfillsOrError.results:[]}),d=(0,nB.$$)(),u=(0,b.C4)(l,b.dT),{loading:h,data:x}=l;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(o.x,{padding:{vertical:12,horizontal:20},flex:{direction:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,r.jsxs)(o.x,{flex:{direction:"column",gap:8},children:[(0,r.jsx)("div",{children:s}),i]}),(0,r.jsx)(b.xi,{refreshState:u})]}),(()=>{if(h&&!x)return(0,r.jsx)(o.x,{padding:{vertical:64},flex:{direction:"column",alignItems:"center"},children:(0,r.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:8},children:[(0,r.jsx)(a.$,{purpose:"body-text"}),(0,r.jsx)("div",{style:{color:p.$()},children:"Loading backfills…"})]})});let t=null==x?void 0:x.partitionBackfillsOrError;return(null==t?void 0:t.__typename)==="PythonError"?(0,r.jsx)(w.T9,{error:t}):t&&(null==t?void 0:t.results.length)?(0,r.jsxs)("div",{children:[d?null:(0,r.jsx)(o.x,{padding:{horizontal:24,bottom:16},children:(0,r.jsx)(nB.So,{})}),(0,r.jsx)(nF.G,{backfills:t.results.slice(0,10),refetch:l.refetch}),t.results.length>0?(0,r.jsx)(o.x,{margin:{top:16},children:(0,r.jsx)(n_.b$,{...c})}):null]}):e.size>0?(0,r.jsx)(o.x,{padding:{vertical:64},children:(0,r.jsx)(tz.t,{icon:"no-results",title:"No matching backfills",description:"No backfills were found for this filter."})}):(0,r.jsx)(o.x,{padding:{vertical:64},children:(0,r.jsx)(tz.t,{icon:"no-results",title:"No backfills found",description:"This instance does not have any backfill jobs."})})})()]})},nq=(0,tp.Ps)(nz(),tK.B,nF.b),nK=()=>((0,k.Px)(),(0,A.j)("Overview | Backfills"),(0,r.jsxs)(nv.T,{children:[(0,r.jsx)(er,{tab:"backfills"}),(0,r.jsx)(nU,{})]}));var nH=n(28879),nV=n.n(nH),nJ=n(64989),nQ=n.n(nJ),nW=n(77491),nY=n.n(nW),nG=n(84927);class nZ{constructor({fetchData:e,onData:t,onError:n}){this.hasMoreData=!0,this.dataSoFar=[],this.currentCursor=void 0,this.stopped=!1,this.fetch=async()=>{if(this.fetchPromise)return await this.fetchPromise;this.fetchPromise=new Promise(async e=>{for(this.hasMoreData=!0;this.hasMoreData&&!this.stopped;){let{cursor:e,hasMore:n,data:r,error:s}=await this.fetchData(this.currentCursor);if(this.stopped)break;if(s){var t;null===(t=this.onError)||void 0===t||t.call(this,s);break}this.currentCursor=e,this.hasMoreData=n,r.length>0&&(this.dataSoFar=this.dataSoFar.concat(r),this.onData(this.dataSoFar))}e()});let e=await this.fetchPromise;return this.fetchPromise=void 0,e},this.stop=()=>{this.stopped=!0},this.fetchData=e,this.onData=t,this.onError=n}}var nX=n(18978);function n0(){let e=(0,ti._)(["\n  query BackfillLogsPageQuery($backfillId: String!, $cursor: String) {\n    partitionBackfillOrError(backfillId: $backfillId) {\n      __typename\n      ... on PythonError {\n        message\n      }\n      ... on BackfillNotFoundError {\n        message\n      }\n      ... on PartitionBackfill {\n        id\n        logEvents(cursor: $cursor) {\n          ... on InstigationEventConnection {\n            cursor\n            hasMore\n            events {\n              ...InstigationEventLog\n            }\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return n0=function(){return e},e}let n1=e=>{if("PartitionBackfill"!==e.partitionBackfillOrError.__typename)return{data:[],hasMore:!1,error:e.partitionBackfillOrError,cursor:void 0};{let{events:t,hasMore:n,cursor:r}=e.partitionBackfillOrError.logEvents;return{data:t,hasMore:n,cursor:r,error:void 0}}},n2=e=>{let{backfill:t}=e,{error:n,fetched:s,refreshState:i}=function(e){let{query:t,variables:n,getResult:r}=e,[s,i]=(0,l.useState)(null),[o,a]=(0,l.useState)(null),c=(0,tp.xJ)(),{stop:d,fetch:u}=(0,l.useMemo)(()=>new nZ({fetchData:async e=>r((await c.query({variables:{...n,cursor:e},query:t})).data),onData:i,onError:a}),[c,t,n,r]);return(0,l.useEffect)(()=>d,[d]),{fetched:s,error:o,refreshState:(0,b.bT)({refresh:u,intervalMs:1e4,leading:!0})}}({query:n3,variables:(0,l.useMemo)(()=>({backfillId:t.id}),[t]),getResult:n1});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:{position:"absolute",right:16,top:-32},children:(0,r.jsx)(b.xi,{refreshState:i})}),(n&&(o.x,tz.t,n.message),null===s)?(0,r.jsx)(o.x,{flex:{justifyContent:"center",alignItems:"center"},style:{flex:1},children:(0,r.jsx)(a.$,{purpose:"page"})}):0===s.length?(0,r.jsx)(o.x,{flex:{justifyContent:"center",alignItems:"center"},style:{flex:1},children:(0,r.jsx)(tz.t,{title:"No logs available",description:"If backfill log storage is enabled, logs will appear as they are emitted by the backfill daemon."})}):(0,r.jsx)(nX.g,{events:s})]})},n3=(0,tp.Ps)(n0(),nX.n);var n4=n(89891),n6=n(31259),n8=n(52338),n5=n(77851),n9=n(70812);function n7(){let e=(0,ti._)(["\n  query BackfillPartitionsForAssetKey($backfillId: String!, $assetKey: AssetKeyInput!) {\n    partitionBackfillOrError(backfillId: $backfillId) {\n      ... on PartitionBackfill {\n        id\n        partitionsTargetedForAssetKey(assetKey: $assetKey) {\n          partitionKeys\n          ranges {\n            start\n            end\n          }\n        }\n      }\n    }\n  }\n"]);return n7=function(){return e},e}let re="60% repeat(4, 1fr)",rt=e=>{var t,n;let{backfill:s}=e,i=(0,l.useRef)(null),a=null!==(n=null===(t=s.assetBackfillData)||void 0===t?void 0:t.assetBackfillStatuses)&&void 0!==n?n:[],c=(0,j.MG)({count:a.length,getScrollElement:()=>i.current,estimateSize:()=>64,overscan:10}),d=c.getTotalSize(),u=c.getVirtualItems();return a.length?(0,r.jsxs)(D.W2,{ref:i,children:[(0,r.jsx)(rr,{backfill:s}),(0,r.jsx)(D.Nh,{$totalHeight:d,children:u.map(e=>{let{index:t,key:n,size:i,start:o}=e;return(0,r.jsx)(rs,{asset:a[t],backfill:s,height:i,start:o},n)})})]}):(0,r.jsx)(o.x,{margin:48,children:(0,r.jsx)(tz.t,{title:"Partition statuses unavailable",description:"Dagster was unable to load per-partition statuses. This may occur if the backfilled assets or jobs no longer exist in your loaded code locations."})})};function rn(e,t){let n=[{token:"tag",value:"dagster/backfill=".concat(e)}];switch(t){case"inProgress":n.push({token:"status",value:tg.VOA.STARTED},{token:"status",value:tg.VOA.QUEUED},{token:"status",value:tg.VOA.STARTING},{token:"status",value:tg.VOA.CANCELING},{token:"status",value:tg.VOA.NOT_STARTED});break;case"complete":n.push({token:"status",value:tg.VOA.SUCCESS});break;case"failed":n.push({token:"status",value:tg.VOA.FAILURE}),n.push({token:"status",value:tg.VOA.CANCELED})}return(0,n8.it)(n)}let rr=e=>{let{backfill:t}=e;return(0,r.jsxs)(D.VJ,{templateColumns:re,sticky:!0,children:[(0,r.jsx)(D.qN,{children:"Asset name"}),(0,r.jsx)(D.qN,{children:(0,r.jsx)(v.rU,{to:rn(t.id,"targeted"),children:"Partitions targeted"})}),(0,r.jsx)(D.qN,{children:(0,r.jsx)(v.rU,{to:rn(t.id,"inProgress"),children:"In progress"})}),(0,r.jsx)(D.qN,{children:(0,r.jsx)(v.rU,{to:rn(t.id,"complete"),children:"Completed"})}),(0,r.jsx)(D.qN,{children:(0,r.jsx)(v.rU,{to:rn(t.id,"failed"),children:"Failed"})})]})},rs=e=>{let t,n,i,l,{asset:a,backfill:c,height:d,start:u}=e;"AssetPartitionsStatusCounts"===a.__typename?(t=a.numPartitionsTargeted,n=a.numPartitionsInProgress,i=a.numPartitionsMaterialized,l=a.numPartitionsFailed):(t=1,l=a.failed?1:0,n=a.inProgress?1:0,i=a.materialized?1:0);let h=(0,tp.xJ)(),p=(0,s.k6)(),m=async(e,t)=>{let n={};if(t){var r;let t=await h.query({query:ro,variables:{backfillId:c.id,assetKey:(0,n6.W1)(e)}}),s="PartitionBackfill"===t.data.partitionBackfillOrError.__typename?t.data.partitionBackfillOrError.partitionsTargetedForAssetKey:null;s&&(null===(r=s.ranges)||void 0===r?void 0:r.length)&&(n={default_range:s.ranges.map(e=>"[".concat(e.start,"...").concat(e.end,"]")).join(",")})}return p.push((0,P.p)(e,n))};return(0,r.jsx)(D.X2,{$height:d,$start:u,"data-testid":(0,n5.N)("backfill-asset-row-".concat((0,S.Je)(a.assetKey))),children:(0,r.jsxs)(ri,{border:"bottom",children:[(0,r.jsx)(D.E5,{children:(0,r.jsxs)(o.x,{flex:{direction:"row",justifyContent:"space-between"},style:{minWidth:0},children:[(0,r.jsx)(n4.Z,{style:{minWidth:0},onClick:()=>m(a.assetKey,"AssetPartitionsStatusCounts"===a.__typename),children:(0,r.jsx)(ey.g,{text:(0,S.ll)(a.assetKey)})}),(0,r.jsx)(rl,{targeted:t,inProgress:n,completed:i,failed:l})]})}),"AssetPartitionsStatusCounts"===a.__typename?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(D.E5,{children:n9.V.format(t)}),(0,r.jsx)(D.E5,{children:n9.V.format(n)}),(0,r.jsx)(D.E5,{children:n9.V.format(i)}),(0,r.jsx)(D.E5,{children:n9.V.format(l)})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(D.E5,{children:"-"}),(0,r.jsx)(D.E5,{children:n?(0,r.jsx)(x.V,{icon:"spinner",intent:"primary",children:"In progress"}):"-"}),(0,r.jsx)(D.E5,{children:i?(0,r.jsx)(x.V,{intent:"success",children:"Completed"}):"-"}),(0,r.jsx)(D.E5,{children:l?(0,r.jsx)(x.V,{intent:"danger",children:"Failed"}):"-"})]})]})})},ri=(0,y.ZP)(o.x).withConfig({componentId:"sc-8d5fb88e-0"})(["display:grid;grid-template-columns:",";height:100%;"],re),ro=(0,tp.Ps)(n7());function rl(e){let{targeted:t,inProgress:n,completed:s,failed:i}=e;return(0,r.jsxs)("div",{style:{borderRadius:"8px",backgroundColor:p.gJ(),display:"grid",gridTemplateColumns:"".concat(100*s/t,"% ").concat(100*i/t,"% ").concat(100*n/t,"%"),gridTemplateRows:"100%",height:"12px",width:"200px",overflow:"hidden"},children:[(0,r.jsx)("div",{style:{background:p.fA()}}),(0,r.jsx)("div",{style:{background:p.FY()}}),(0,r.jsx)("div",{style:{background:p.L$()}})]})}let{DATE_TIME_HEIGHT:ra,ONE_HOUR_MSEC:rc,EMPTY_STATE_HEIGHT:rd,LEFT_SIDE_SPACE_ALLOTTED:ru}={ROW_HEIGHT:32,DATE_TIME_HEIGHT:64,TIME_HEADER_HEIGHT:32,ONE_HOUR_MSEC:36e5,EMPTY_STATE_HEIGHT:110,LEFT_SIDE_SPACE_ALLOTTED:320},rh=e=>{let{loading:t=!1,runs:n,rangeMs:s,annotations:i,now:a}=e,c=l.useRef(null),{viewport:{width:d,height:h},containerProps:{ref:x}}=(0,u.S)(),p=(0,j.MG)({count:n.length,getScrollElement:()=>c.current,estimateSize:e=>32,overscan:40}),m=p.getTotalSize(),g=p.getVirtualItems();return d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.x,{padding:{left:24},border:"bottom",flex:{direction:"column",justifyContent:"center"},style:{fontSize:"16px",flex:"0 0 ".concat(ra,"px")}}),(0,r.jsx)("div",{style:{position:"relative"},children:(0,r.jsx)(eY,{now:a,interval:s[1]-s[0]>4*rc?rc:rc/6,rangeMs:s,annotations:i,height:n.length>0?h:0})}),n.length?(0,r.jsx)("div",{ref:x,style:{overflow:"hidden",position:"relative"},children:(0,r.jsx)(D.W2,{ref:c,children:(0,r.jsx)(D.Nh,{$totalHeight:m,children:g.map(e=>{let{index:t,key:i,size:o,start:l}=e;return(0,r.jsx)(rp,{run:n[t],top:l,height:o,range:s,width:d},i)})})})}):(0,r.jsx)("div",{ref:x,children:(0,r.jsx)(rx,{loading:t})})]}):(0,r.jsx)("div",{style:{height:ra+rd},ref:x})},rx=e=>{let{loading:t}=e;return(0,r.jsx)(o.x,{background:p.v8(),padding:{vertical:24},flex:{direction:"row",justifyContent:"center"},border:"top-and-bottom",children:t?(0,r.jsxs)(o.x,{flex:{direction:"row",gap:8,alignItems:"center"},children:[(0,r.jsx)(a.$,{purpose:"body-text"}),"Loading runs"]}):(0,r.jsx)(o.x,{flex:{direction:"column",gap:12,alignItems:"center"},children:(0,r.jsx)("div",{children:"No runs were executing in this time period."})})})},rp=e=>{let{run:t,top:n,height:s,range:i,width:a}=e,[c,d]=i,u=a-ru,h=l.useMemo(()=>eT({runs:[t],start:c,end:d,width:u,minChunkWidth:4,minMultipleWidth:4})[0],[t,c,d,u]);return(0,r.jsxs)(e8,{$height:s,$start:n,children:[(0,r.jsxs)(o.x,{style:{width:ru},padding:{horizontal:24},flex:{justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsxs)(o.x,{flex:{alignItems:"center",gap:4},children:[(0,r.jsx)(eb.O_,{status:t.status,size:12}),(0,r.jsx)(v.rU,{to:"/runs/".concat(t.id),children:t.id.slice(0,8)})]}),(0,r.jsx)(eE.Q,{startUnix:t.startTime/1e3,endUnix:t.endTime/1e3})]}),(0,r.jsx)(e9,{children:h&&(0,r.jsx)(e7,{$background:eP(h.runs),$multiple:!1,style:{left:"".concat(h.left,"px"),width:"".concat(h.width,"px")}})})]})};var rm=n(33298),rg=n(74928),rf=n(85062);let rj=e=>{let{backfill:t}=e,[n,s]=(0,O.q)({defaults:{view:"timeline"},queryKey:"view"}),{rangeMs:a,hourWindow:c,setHourWindow:d,onPageEarlier:u,onPageLater:h,onPageNow:x}=tO({maxNowMs:t.endTimestamp?1e3*t.endTimestamp:void 0,hourWindowStorageKey:"dagster.backfill-run-timeline-hour-window",hourWindowDefault:"1",lookaheadHours:.1}),p=(0,l.useMemo)(()=>({tags:[{key:tu.H.Backfill,value:t.id}]}),[t]),m=(0,l.useMemo)(()=>t.endTimestamp?[{ms:1e3*t.timestamp,label:"Start"},{ms:1e3*t.endTimestamp,label:"End"}]:[{ms:1e3*t.timestamp,label:"Start"}],[t.timestamp,t.endTimestamp]),g=(0,r.jsxs)(o.x,{flex:{direction:"row",gap:16},style:{position:"sticky",top:0},children:[(0,r.jsx)(es.h,{activeItems:new Set([n]),onClick:e=>{s(e)},buttons:[{id:"timeline",icon:"gantt_waterfall",label:"Timeline"},{id:"list",icon:"list",label:"List"}]}),(0,r.jsx)("div",{style:{flex:1}}),"timeline"===n&&(0,r.jsx)(es.h,{activeItems:new Set([c]),buttons:[{id:"1",label:"1hr"},{id:"6",label:"6hr"},{id:"12",label:"12hr"},{id:"24",label:"24hr"}],onClick:e=>d(e)}),"timeline"===n&&(0,r.jsxs)(o.x,{flex:{direction:"row",gap:4,alignItems:"center"},children:[(0,r.jsx)(i.zx,{onClick:u,children:"←"}),(0,r.jsx)(i.zx,{onClick:x,children:t.endTimestamp?"Jump to end":"Now"}),(0,r.jsx)(i.zx,{onClick:h,children:"→"})]})]});return"timeline"===n?(0,r.jsx)(ry,{filter:p,rangeMs:a,annotations:m,actionBarComponents:g}):(0,r.jsx)(rv,{filter:p,actionBarComponents:g})},rv=e=>{var t;let{filter:n,actionBarComponents:s}=e,{queryResult:i,paginationProps:l}=(0,rg.E)(n,25),c=null===(t=i.data)||void 0===t?void 0:t.pipelineRunsOrError,d=(0,b.C4)(i,15e3);return c?"Runs"!==c.__typename?(0,r.jsx)(o.x,{padding:{vertical:64},children:(0,r.jsx)(tz.t,{icon:"error",title:"Query error",description:c.message})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:{position:"absolute",right:16,top:-32},children:(0,r.jsx)(b.xi,{refreshState:d})}),(0,r.jsx)(o.x,{style:{flex:1,overflowY:"auto"},children:(0,r.jsxs)(rf.Y,{$top:56,children:[(0,r.jsx)(rm.A,{runs:c.results,emptyState:()=>(0,r.jsx)(o.x,{padding:{vertical:24},border:"top-and-bottom",flex:{direction:"column",alignItems:"center"},children:"No runs have been launched."}),actionBarComponents:s,actionBarSticky:!0}),c.results.length>0?(0,r.jsx)(o.x,{margin:{vertical:16},children:(0,r.jsx)(n_.pI,{...l})}):null]})})]}):(0,r.jsx)(o.x,{padding:{vertical:48},children:(0,r.jsx)(a.$,{purpose:"page"})})},ry=e=>{let{rangeMs:t,annotations:n,filter:s,actionBarComponents:i}=e,a=tC({refreshInterval:2*b.dT,showTicks:!1,rangeMs:t,filter:s}),{jobs:c,loading:d}=(0,l.useDeferredValue)(a),u=c[0],{runs:h,now:x}=l.useMemo(()=>{let e=Date.now();return u?{runs:[...u.runs].sort((e,t)=>t.startTime-e.startTime),now:e}:{runs:[],now:e}},[u]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:{position:"absolute",right:16,top:-32},children:(0,r.jsx)(b.xi,{refreshState:a.refreshState})}),(0,r.jsx)(o.x,{padding:{horizontal:24,vertical:12},style:{position:"sticky",top:0,zIndex:2,background:p.v8()},border:"bottom",children:i}),(0,r.jsx)(ei.S,{region:"timeline",children:(0,r.jsx)(rh,{loading:d,rangeMs:t,annotations:n,runs:h,now:x})})]})};var rw=n(32959),rb=n(34667),rk=n(32093),rC=n(22791);function rE(){let e=(0,ti._)(["\n  query BackfillStatusesByAsset($backfillId: String!) {\n    partitionBackfillOrError(backfillId: $backfillId) {\n      ...BackfillDetailsBackfillFragment\n      ...PythonErrorFragment\n      ... on BackfillNotFoundError {\n        message\n      }\n    }\n  }\n\n  fragment BackfillDetailsBackfillFragment on PartitionBackfill {\n    id\n    status\n    timestamp\n    endTimestamp\n    numPartitions\n    ...BackfillActionsBackfillFragment\n\n    error {\n      ...PythonErrorFragment\n    }\n    assetBackfillData {\n      rootTargetedPartitions {\n        partitionKeys\n        ranges {\n          start\n          end\n        }\n      }\n      assetBackfillStatuses {\n        ... on AssetPartitionsStatusCounts {\n          assetKey {\n            path\n          }\n          numPartitionsTargeted\n          numPartitionsInProgress\n          numPartitionsMaterialized\n          numPartitionsFailed\n        }\n        ... on UnpartitionedAssetStatus {\n          assetKey {\n            path\n          }\n          inProgress\n          materialized\n          failed\n        }\n      }\n    }\n  }\n\n  ","\n  ","\n"]);return rE=function(){return e},e}function rS(){let e=(0,ti._)(["\n  query BackfillPartitionsForAssetKey($backfillId: String!, $assetKey: AssetKeyInput!) {\n    partitionBackfillOrError(backfillId: $backfillId) {\n      ... on PartitionBackfill {\n        id\n        partitionsTargetedForAssetKey(assetKey: $assetKey) {\n          partitionKeys\n          ranges {\n            start\n            end\n          }\n        }\n      }\n    }\n  }\n"]);return rS=function(){return e},e}nV().extend(nQ()),nV().extend(nY());let rT=()=>{let{featureContext:e}=(0,l.useContext)(rk.U),{backfillId:t}=(0,s.UO)();(0,k.Px)(),(0,A.j)("Backfill | ".concat(t));let[n,i]=(0,O.q)({queryKey:"tab",defaults:{tab:"partitions"}}),c=(0,nB.$$)(),u=(0,tp.aM)(rA,{variables:{backfillId:t}}),{data:h,error:x}=u,m=(null==h?void 0:h.partitionBackfillOrError.__typename)==="PartitionBackfill"?h.partitionBackfillOrError:null,g=!m||[tg.Jv3.REQUESTED,tg.Jv3.CANCELING].includes(m.status),j=(0,b.C4)(u,1e4,g);return(0,r.jsxs)(o.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,r.jsx)(Q.m,{title:(0,r.jsxs)(f.X6,{children:[(0,r.jsx)(v.rU,{to:"/overview/backfills",style:{color:p.$()},children:"Backfills"})," / ",t]}),right:(0,r.jsxs)(o.x,{flex:{gap:12,alignItems:"center"},children:[g?(0,r.jsx)(b.xi,{refreshState:j}):null,m?(0,r.jsx)(nG.WH,{backfill:m,refetch:u.refetch,canCancelRuns:m.status===tg.Jv3.REQUESTED}):null]})}),function(){var t;if(!h||!h.partitionBackfillOrError)return(0,r.jsx)(o.x,{padding:64,"data-testid":(0,n5.N)("page-loading-indicator"),children:(0,r.jsx)(a.$,{purpose:"page"})});if("PythonError"===h.partitionBackfillOrError.__typename)return(0,r.jsx)(w.T9,{error:h.partitionBackfillOrError});if("BackfillNotFoundError"===h.partitionBackfillOrError.__typename)return(0,r.jsx)(tz.t,{icon:"no-results",title:h.partitionBackfillOrError.message});let s=h.partitionBackfillOrError;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(o.x,{padding:24,flex:{direction:"row",justifyContent:"space-between",wrap:"nowrap",alignItems:"center"},"data-testid":(0,n5.N)("backfill-page-details"),children:[(0,r.jsx)(rI,{label:"Created",detail:(0,r.jsx)(rC.E,{timestamp:{ms:Number(1e3*s.timestamp)},timeFormat:{showSeconds:!0,showTimezone:!1}})}),(0,r.jsx)(rI,{label:"Duration",detail:(0,r.jsx)(rP,{start:1e3*s.timestamp,end:s.endTimestamp?1e3*s.endTimestamp:null})}),(0,r.jsx)(rI,{label:"Partition selection",detail:(0,r.jsx)(rb.b,{targetPartitionCount:s.numPartitions||0,targetPartitions:null===(t=s.assetBackfillData)||void 0===t?void 0:t.rootTargetedPartitions})}),(0,r.jsx)(rI,{label:"Status",detail:(0,r.jsx)(rw.w,{backfill:s})})]}),c?null:(0,r.jsx)(o.x,{padding:{horizontal:24,bottom:16},children:(0,r.jsx)(nB.So,{})}),(0,r.jsx)(o.x,{padding:{left:24},border:"bottom",children:(0,r.jsxs)(Y.mQ,{size:"large",selectedTabId:n,children:[(0,r.jsx)(Y.OK,{id:"partitions",title:"Partitions",onClick:()=>i("partitions")}),(0,r.jsx)(Y.OK,{id:"runs",title:"Runs",onClick:()=>i("runs")}),e.canSeeBackfillCoordinatorLogs?(0,r.jsx)(Y.OK,{id:"logs",title:"Coordinator logs",onClick:()=>i("logs")}):null]})}),(null==x?void 0:x.graphQLErrors)&&(0,r.jsx)(d.b,{intent:"error",title:x.graphQLErrors.map(e=>e.message)}),(0,r.jsxs)(o.x,{flex:{direction:"column"},style:{flex:1,position:"relative",minHeight:0},children:["partitions"===n&&(0,r.jsx)(rt,{backfill:s}),"runs"===n&&(0,r.jsx)(rj,{backfill:s}),"logs"===n&&(0,r.jsx)(n2,{backfill:s})]})]})}()]})},rI=e=>{let{label:t,detail:n}=e;return(0,r.jsxs)(o.x,{flex:{direction:"column",gap:4},style:{minWidth:"280px"},children:[(0,r.jsx)(rM,{children:t}),(0,r.jsx)("div",{children:n})]})},rM=y.ZP.div.withConfig({componentId:"sc-82c6d6a3-0"})(["color:",";font-size:12px;line-height:16px;"],p.$()),rP=e=>{let{start:t,end:n}=e,[s,i]=(0,l.useReducer)((e,t)=>e+1,0);(0,l.useEffect)(()=>{if(n)return;let e=setInterval(i,1e3);return()=>clearInterval(e)},[t,n]);let o=n?n-t:Date.now()-t;return(0,r.jsx)("span",{children:rO(o)})},rA=(0,tp.Ps)(rE(),tK.B,nG.V2);(0,tp.Ps)(rS());let rO=e=>{let t=Math.floor(e/1e3%60),n=Math.floor(e/6e4%60),r=Math.floor(e/36e5%24),s=Math.floor(e/864e5),i="";return s>0?i+="".concat(s,"d ")+"".concat(r,"h"):r>0?i+="".concat(r,"h ")+"".concat(n,"m"):n>0?i+="".concat(n,"m ")+"".concat(t,"s"):t>0&&(i+="".concat(t,"s")),i.trim()},rN=()=>{let{flagSettingsPage:e}=(0,G.gV)(),t=(0,X.I)();return(0,r.jsxs)(s.rs,{children:[(0,r.jsx)(tD.A,{path:"/overview/activity",isNestingRoute:!0,children:(0,r.jsx)(t_,{})}),(0,r.jsx)(tD.A,{path:"/overview/jobs",render:()=>e?(0,r.jsx)(s.l_,{to:"/jobs"}):(0,r.jsx)(tB,{})}),(0,r.jsx)(tD.A,{path:"/overview/schedules",render:()=>e?(0,r.jsx)(s.l_,{to:"/automation"}):(0,r.jsx)(ns,{})}),(0,r.jsx)(tD.A,{path:"/overview/sensors",render:()=>e?(0,r.jsx)(s.l_,{to:"/automation"}):(0,r.jsx)(nj,{})}),(0,r.jsx)(tD.A,{path:"/overview/automation",render:()=>e&&"has-global-amp"!==t?(0,r.jsx)(s.l_,{to:"/automation"}):(0,r.jsx)(nD,{})}),(0,r.jsx)(tD.A,{path:"/overview/backfills/:backfillId",render:()=>(0,r.jsx)(rT,{})}),(0,r.jsx)(tD.A,{path:"/overview/backfills",exact:!0,render:()=>(0,r.jsx)(nK,{})}),(0,r.jsx)(tD.A,{path:"/overview/resources",children:(0,r.jsx)(tQ,{})}),(0,r.jsx)(tD.A,{path:"*",isNestingRoute:!0,render:()=>(0,r.jsx)(s.l_,{to:"/overview/activity"})})]})};var rD=rN},38267:function(e,t,n){n.d(t,{Q1:function(){return y},Qf:function(){return w},zc:function(){return v}});var r=n(73235),s=n(52322),i=n(38491),o=n(39013),l=n(18149),a=n.n(l),c=n(2784),d=n(7267),u=n(35505),h=n(59351),x=n(52338),p=n(20958),m=n(20171),g=n(88610);function f(){let e=(0,r._)(["\n  query RunTabsCountQuery($queuedFilter: RunsFilter!, $inProgressFilter: RunsFilter!) {\n    queuedCount: pipelineRunsOrError(filter: $queuedFilter) {\n      ... on Runs {\n        count\n      }\n    }\n    inProgressCount: pipelineRunsOrError(filter: $inProgressFilter) {\n      ... on Runs {\n        count\n      }\n    }\n  }\n"]);return f=function(){return e},e}let j=e=>{switch(e){case"all":return"Runs | All runs";case"failed":return"Runs | Failed";case"in-progress":return"Runs | In progress";case"queued":return"Runs | Queued";case"scheduled":return"Runs | Scheduled";default:return"Runs"}},v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,p.aM)(b,{variables:{queuedFilter:{...e,statuses:Array.from(h.sy)},inProgressFilter:{...e,statuses:Array.from(h.Ys)}}}),{data:n}=t,{queuedCount:r,inProgressCount:o}=(0,c.useMemo)(()=>{var e,t;return{queuedCount:(null==n?void 0:null===(e=n.queuedCount)||void 0===e?void 0:e.__typename)==="Runs"?n.queuedCount.count:null,inProgressCount:(null==n?void 0:null===(t=n.inProgressCount)||void 0===t?void 0:t.__typename)==="Runs"?n.inProgressCount.count:null}},[n]),[l]=(0,x.oD)(),a=w(l);(0,m.j)(j(a));let d=e=>{let t=l.filter(e=>"status"!==e.token),n=e.map(e=>({token:"status",value:e}));return(0,x.it)([...n,...t])};return{tabs:(0,s.jsxs)(i.zH,{children:[(0,s.jsx)(y,{to:d([]),id:"all",$active:"all"===a,children:"All runs"}),(0,s.jsxs)(y,{to:d(Array.from(h.sy)),id:"queued",$active:"queued"===a,children:["Queued (",null!=r?r:"indeterminate",")"]}),(0,s.jsxs)(y,{to:d(Array.from(h.Ys)),id:"in-progress",$active:"in-progress"===a,children:["In progress (",null!=o?o:"indeterminate",")"]}),(0,s.jsx)(y,{to:d(Array.from(h.hd)),id:"failed",$active:"failed"===a,children:"Failed"}),(0,s.jsx)(y,{title:"Scheduled",to:"/runs/scheduled",id:"scheduled",$active:"scheduled"===a,children:"Scheduled"})]}),queryResult:t}},y=(0,u.ZP)(g.A).withConfig({componentId:"sc-56e7dbb1-0"})(["color:",";&&:hover{color:",";}",""],o.$(),o.$(),e=>{let{$active:t}=e;return t?(0,u.iv)(["background-color:",";color:",";&&:hover{background-color:",";color:",";}"],o.AU(),o.Ep(),o.AU(),o.Ep()):(0,u.iv)(["background-color:",";"],o.v8())}),w=e=>{let{pathname:t}=(0,d.TH)();if("/runs/timeline"===t)return"timeline";if("/runs/scheduled"===t)return"scheduled";if("/overview/backfills"===t)return"backfills";let n=new Set(e.filter(e=>"status"===e.token).map(e=>e.value));return a()(h.sy,n)?"queued":a()(h.Ys,n)?"in-progress":a()(h.hd,n)?"failed":"all"},b=(0,p.Ps)(f())}}]);
//# sourceMappingURL=2608.aa2ee049c82fc24e.js.map